import com.biomatters.geneious.publicapi.documents.sequence.SequenceDocument;
import com.biomatters.geneious.publicapi.implementations.sequence.DefaultNucleotideSequence;
import com.biomatters.geneious.publicapi.implementations.sequence.DefaultSequenceDocument;
import com.biomatters.geneious.publicapi.plugin.TestGeneious;
import com.google.common.collect.Lists;
import crossover.CrossoverUtil;
import crossover.utils.CrossoverUtils;
import org.apache.commons.lang3.StringUtils;
import org.apache.http.HttpVersion;
import org.apache.http.client.fluent.Form;
import org.apache.http.client.fluent.Request;
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.junit.Before;
import org.junit.Test;

import java.io.IOException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.regex.Matcher;
import java.util.regex.Pattern;
import java.util.stream.Collectors;
import java.util.stream.Stream;

import static org.hamcrest.CoreMatchers.is;
import static org.hamcrest.MatcherAssert.assertThat;
import static org.hamcrest.core.IsEqual.equalTo;
//see https://assets.geneious.com/developer/geneious/javadoc/latest/index.html

@SuppressWarnings({"ImplicitNumericConversion", "HardcodedFileSeparator", "ClassHasNoToStringMethod"})
public class CrossoverTest {
    boolean post = true;

    @Test//real data
    public void testCrossoverStatisticsForChimera9AndWT256() throws Exception { //fine
        ArrayList<SequenceDocument> allSequences = new ArrayList<>();
        allSequences.add(new DefaultNucleotideSequence("wt2 Sequence", "ATGGCTGCCGATGGTTATCTTCCAGATTGGCTCGAGGACACTCTCTCTGAAGGAATAAGAC-AGTGGTGGAAGCTC-AAACCTGGC-CCACCACCACC-AAAGCCCGCAGAGCGGCATAAGGA-CGACAGCAGGGGTCTTGTGCTTCCTGGGTACAAGTACCTCGGACCCTTCAACGGACTCGA-CAAGGGAGAGCCGGTCAACGAGGCAGACGCCGCGGCCCTCGAGCACGACAAAGCCTACGACCGGCAGCTCGACAGCGGA-GACAACCCGTACCT-CAAGTACAACCACGCCGACGCGGAGTTTCAGGAGC-GCCTTAAAGAAGATACGTCTTTTGGGGGCAACCTCGGACGAGCAGTCTTCCAGGCGAAAAAGAGGGTTCTTGAACCTCTGGGCCTGGTTGAGGAACCTGTTAAGACGGCTCCGGGAAAAAAGAGGCCGGTA-GAGCACTCTCCTGTG-GAGCCAGACTCCTCCTCGGGAACCGGAAAGGCGGGCCAGCAGCCTGCAAGAAAAAGATTGAATTTTGGTCAGACTGGAGACGC-AGACTCAGTACCTGACCCCCAGCCTCTCGGACAGCCACCAGC--AGCCC-CCTCTGGTCTGGGAACTAATACGATGGCTACAGGCAGTGGCG-CACCAATGG-CAGACAATAACGAGGGCGCCGACGGAGTGGGTAATTCCTCGGGAAATTGGCATTGCGATTCCACATGGATGGGCGACAGAGTCATCACCACCAG--CACCCGAACCTGGGCCCTGCCCACCTACAACAACCACCTCTAC-AAACAAATTTCCA--G-C--CAATCAGGAGCCTCG-AACGACAAT-CACTACTTTGGCTACAGCACCCCTTGGGGGTATTTTGACTTCAACAGATTCCACTGCCACTTTT-CACCACGTGACTGGCAAAGACTCATCAACAACAACTGGGGATTCCGACCCAAGAGACTCAACTTCAAGCTCTTTAACATTCAAGTCAAAGAGGTCACGCA-GAATGACGGTACGACGACGATTGCCAATAACCTTACCAGCACGGTTCAGGTGTTTACTGACT-CGGAGTACCAGCTCCCGTACGTCCTCGGCT-CGGCGCATC-AAGGATGCCTCCCG-CCGTTCCCAGCAGACGTCTTCATGGTGCCACAGTATGGATACCTCACCCTGAACAACGGGAGT-CAGGCAGT---A--G-GACGCTCTTCATTTTACTGCCTGGAGTACTTTCCTTCTCA-GATGCTGCGTACCGGAAACAACTTTACCTTCAGCTACACTTTTGAGGACGTTCCTTTCCACAGCAGCTACGCTCACAGCCAGAGTCTGGACCGTCTCATGAATCCTCTCATCGACCAGTACCTGTATTACTT-GAGCAGAAC--AAACACTCCAAGT--G-GAACCACCA-CGCAGTCAAGG-CTTCAGTTTTCTCAGGCCGGAG----CGAG-TGACAT-TCGGGACCAGTCTAGGAACTGGCTTCCTGGACCC-TGTTACCG---CCAGCAGC-GAGTATCAAAGACATCTGCGGATAACAACAACAGTGAATACT-CGTGGACTG-GAGCTACCAAGTACCACCTCAATGG-CAGAGACTCTCTGGTGAATCCGGGCC-CGGCCATGGCAAGC-CACAAGGACGATGAAGAAA--AGTTTTT-T-CCTCA-GAGCGGGGTTCTCATCTTTGGGAAGC-AA--GGC---TCAGAGAAAACA--AATGTGGACATTG--AA-AAGGT-CATGATTAC-AGACGAAGAG-GAAATCAGGACAACC-AATCCCGTGGC-TACGGAGCAG-TATG-GTTCTG-TATCTACCAACCTCCAGAGAGGCA--ACAGACAAGCAGCTACCGCAGATGTCAACA-CAC--A-AGGCGTTCTT-CCAGGCATG-GTCTGGCA-GGACAGAGATGTGTACCTTCAGGGGCCCATCTGGGCAAAGATTCCACACACGGACGG-ACATTTTCACCCCTCTCCCCTCATGGGTGGATTCGGACTTAAACACCCTCCTCCACA-GATTCTCATCAAGAACACCCCGGTACCTGCGAATCCTTCGACC-A-CCT-TCAGTGC-GGCAAAGTTTGCTTCCTTCATCACACAGTACTCCACGGGACAGGTCAGCGTGGAGATCGAGTGGGAGCTGCA-GAAGGAAAACAGCAAACGCTGGAATCCCGAAATTCAGTACACTTCCAACTACAACAAG-TCTGTTAAT--GTGGACTTTACTGTGGACACTAATGG-CGTGTATTCAGAGCC-TC-GCCCCATTGGCACCAGATACCTGACTCGTAATCTGTAA"));
        allSequences.add(new DefaultNucleotideSequence("wt5 Sequence", "ATGTCTTTTGTTGATCACCCTCCAGATTGGTTGGAAGA-AGT-TGG-TGAAGGTCTTCG-CGAGTTTTTGGGCCTTGAAGCG-GGC-CCACCGAAACCAAAACCCAATC-AGCAGCATCAAGATCAA-GCCCGTGGTCTTGTGCTGCCTGGTTATAACTATCTCGGACCCGGAAACGGTCTCGATCGAGG-AGAGCCTGTCAACAGGGCAGACGAGGTCGCGCGAGAGCACGACATCTCGTACAACGAGCAGCTTGA-GGCGGGAGACAACCCCTACCT-CAAGTACAACCACGCGGACGCCGAGTTTCAGGAGAAGCTCGCC-GACGACACATCCTTCGGGGGAAACCTCGGAAAGGCAGTCTTTCAGGCCAAGAAAAGGGTTCTCGAACCTTTTGGCCTGGTTGAAGAGGGTGCTAAGACGGCCCCTACCGGAAAGCGGATAG-ACGACCACTTTCC-AAA-AAGAAAGAAGGCTC---GG--ACCG--AAGA--GG--A-C--TC--C----AAGCC-TTCCACCTCG-TCAGAC-GCCGAAGCTGGACCCAG---CGGATCC-CAGCAGCT-GCA-AATC-CCAGCCCAACCAGCCTCAAGTTTGGGAGCTGATACAATGTCTGCGGGAGGTGGCGGC-CCATTGGGC-GACAATAACCAAGGTGCCGATGGAGTGGGCAATGCCTCGGGAGATTGGCATTGCGATTCCACGTGGATGGGGGACAGAGTCGTCACCA--AGTCCACCCGAACCTGGGTGCTGCCCAGCTACAACAACCACCAGTACCGAG-AGATCAAAAGCGGCTCCGT-CGACGGA-A-GCAACGCCAACGC-CTACTTTGGATACAGCACCCCCTGGGGGTACTTTGACTTTAACCGCTTCCACAGCCACTGGAGCCCC-CGAGACTGGCAAAGACTCATCAACAACTACTGGGGCTTCAGACCCCGGTCCCTCAGAGTCAAAATCTTCAACATTCAAGTCAAAGAGGTCACG-GTGCAGGACTCCACCACCACCATCGCCAACAACCTCACCTCCACCGTCCAAGTGTTTACGGACGACG-ACTACCAGCTGCCCTACGTCGTCGGCAACGG-G-ACCGAGGGATGCCTGCCGGCC-TTCCCTCCGCAGGTCTTTACGCTGCCGCAGTACGGTTACGCGACGCTGAACCGCGACAACACAGAAAATCCCACCGAGAGGAGCAGCTTCTT-CTGCCTAGAGTACTTTCC-CAGCAAGATGCTGAGAACGGGCAACAACTTTGAGTTTACCTACAACTTTGAGGAGGTGCCCTTCCACTCCAGCTTCGCTCCCAGTCAGAACCTGTTCAAGCTGGCCAACCCGCTGGTGGACCAGTACTTGTACCGCTTCGTG-AGCAC--AAATA-AC--ACTG-GCGGAGT-CCAGTTCAA-CAAGAACCT--G--GCC---G---GGAGATA-C--GCCAACAC--C----T-A--C-AAAAACTGGTTCCCGGGGCCCATGG-GCCGAACCCAG-GGCTG-GAACCTGGG-C-TCCGGGGTCAACCGCGCCAGTG-TCAGCGCCTTCGCCACGACCAATAGGATG-GAGCTCGA-GGGC-GCGAGTTACCAG-GTGCCCCCGCAGCCGA-ACGGCAT-GAC-CAACAACCTCCAGGGCAGCAACACCTATGCCCTG-GAG-AACACTATGATCTTCA-ACAGCCAGCCGGCGAACCCGGGCAC-CACCGCCACGTACCTCGAGGGCAACATGC-TCATCACCAG-CGA-GAGCGAGA-CGCAGCCGGTGAACCGCGTGGCGTAC--AA-CG-TCGGCGGGCAGATGGCCACCAACAACCAGAGCTCCACCACTGCCC--CCGCGACCGGC-ACGT--ACAACCTCCA-GGAAAT-CGTGCCCGGCA-GCGTGTGG-ATGGAGAGGGACGTGTACCTCCAAGGACCCATCTGGGCCAAGATCCCAGAGACGGG-GGCGCACTTTCACCCCTCTCCGGCCATGGGCGGATTCGGACTCAAACACCCACCGCC-CATGATGCTCATCAAGAACACGCCTGTGCCCG-GAAATAT-C-ACC-AGCTTCTCGG-ACGTGCCC-GTCAGCAGC-TTCATCACCCAGTACAGCACCGGGCAGGTCACCGTGGAGATGGAGTGGGAGCT-CAAGAAGGAAAACTCCAAGAGGTGGAACCCAGAGATCCAGTACACAAACAACTACAACGA--CCC-CCAGTTTGTGGACTTTGCCCCGGACAGCACCGGG-GA--ATACAGAACCACCAGACCTATCGGAACCCGATACCTTACCCGACCCCTTTAA"));
        allSequences.add(new DefaultNucleotideSequence("wt6 Sequence", "ATGGCTGCCGATGGTTATCTTCCAGATTGGCTCGAGGACAACCTCTCTGAGGGCATTCG-CGAGTGGTGGGA-CTTGAAACCTGGAGCC-CCGAAACCCAAAGCCAACC-AGCAAAAGCAGGA-CGACGGCCGGGGTCTGGTGCTTCCTGGCTACAAGTACCTCGGACCCTTCAACGGACTCGA-CAAGGGGGAGCCCGTCAACGCGGCGGATGCAGCGGCCCTCGAGCACGACAAGGCCTACGACCAGCAGCTCAA-AGCGGGTGACAATCCGTACCTGCG-GTATAACCACGCCGACGCCGAGTTTCAGGAGC-GTCTGCAAGAAGATACGTCTTTTGGGGGCAACCTCGGGCGAGCAGTCTTCCAGGCCAAGAAGAGGGTTCTCGAACCTTTTGGTCTGGTTGAGGAAGGTGCTAAGACGGCTCCTGGAAAGAAACGTCCGGTA-GAGCAGTCGCC-ACAAGAGCCAGACTCCTCCTCGGGCATTGGCAAGACAGGCCAGCAGCCCGCTAAAAAGAGACTCAATTTTGGTCAGACTGGCGACTC-AGAGTCAGTCCCCGACCCACAACCTCTCGGAGAACCTCCAGC--AACCC-CCGCTGCTGTGGGACCTACTACAATGGCTTCAGGCGGTGGCG-CACCAATGG-CAGACAATAACGAAGGCGCCGACGGAGTGGGTAATGCCTCAGGAAATTGGCATTGCGATTCCACATGGCTGGGCGACAGAGTCATCACCACCAG--CACCCGAACATGGGCCTTGCCCACCTATAACAACCACCTCTAC-AAGCAAATCTCCAGTG-CTTCAA-CGGGGGCCA-GCAACGACAAC-CACTACTTCGGCTACAGCACCCCCTGGGGGTATTTTGATTTCAACAGATTCCACTGCCATTTCT-CACCACGTGACTGGCAGCGACTCATCAACAACAATTGGGGATTCCGGCCCAAGAGACTCAACTTCAAGCTCTTCAACATCCAAGTCAAGGAGGTCACG-ACGAATGATGGCGTCACGACCATCGCTAATAACCTTACCAGCACGGTTCAAGTCTTCTCGGACT-CGGAGTACCAGTTGCCGTACGTCCTCGGCT-CTGCGCACC-AGGGCTGCCTCCCT-CCGTTCCCGGCGGACGTGTTCATGATTCCGCAGTACGGCTACCTAACGCTCAACAATGGCAGC-CAGGCAGT---G--G-GACGGTCATCCTTTTACTGCCTGGAATATTTCCCATCGCA-GATGCTGAGAACGGGCAATAACTTTACCTTCAGCTACACCTTCGAGGACGTGCCTTTCCACAGCAGCTACGCGCACAGCCAGAGCCTGGACCGGCTGATGAATCCTCTCATCGACCAGTACCTGTATTACCT-GAACAGAACTCAGA-A-TC--AGTCCG-GAAGTGCC--CAAAA-CAAGGACTT--GCTGTTT-AG-CCGGGGGTCTCCAGCTGGCATGTCTGT-TCAGCCCAAAAACTGGCTACCTGGACCC-TGTTACCG---GCAGCAGC-GCGTTTCTAAAACAAAAACAGACAACAACAACAGCAACT-TTACCTGGACTG-GTGCTTCAAAATATAACCTTAATGGGC-GTGAATCTATAATCAACCCTGGCA-CTGCTATGGCCT-CACACAAAGACGACAAAGACA--AGTTCTT-T-CC-CATGAGCGGTGTCATGATTTTTGGAAAGG-AG--AGCG--CCGGAGCTT-CA--AACACTG-CATTG--GACAATGT-CATGATCAC-AGACGAAGAG-GAAATCAAAGCCACT-AACCCCGTGGC-CACCGAA-AGATTTG-GGACTG-TGGCAGTCAATCTCCAGAGCAGCAGCACAGACC--CTGCGACCGGAGATGT--GCA-TGTT-ATGGGAGC-CTTACCTGGAATG-GTGTGGCA-AGACAGAGACGTATACCTGCAGGGTCCTATTTGGGCCAAAATTCCTCACACGGATGG-ACACTTTCACCCGTCTCCTCTCATGGGCGGCTTTGGACTTAAGCACCCGCCTCCTCA-GATCCTCATCAAAAACACGCCTGTTCCTGCGAATCCTCCGGCAGAGTTT-TC-G-GC-TACAAAGTTTGCTTCATTCATCACCCAGTATTCCACAGGACAAGTGAGCGTGGAGATTGAATGGGAGCTGCA-GAAAGAAAACAGCAAACGCTGGAATCCCGAAGTGCAGTATACATCTAACTATG-CAAAATCTGCCAAC--GTTGATTTCACTGTGGACAACAATGGACTT-TATACTGAGCC-TC-GCCCCATTGGCACCCGTTACCTCACCCGTCCCCTGTAA"));
        allSequences.add(new DefaultNucleotideSequence("9 Sequence--", "ATGGCTGCCGATGGTTATCTTCCAGATTGGCTCGAGGACAACCTCTCTGAGGGCATTCG-CGAGTGGTGGGA-CTTGAAACCTGGAGCC-CCGAAACCCAAAGCCAACC-AGCAAAAGCAGGA-CGACGGCCGGGGTCTGGTGCTTCCTGGCTACAAGTACCTCGGACCCTTCAACGGACTCGA-CAAGGGGGAGCCCGTCAACGCGGCGGATGCAGCGGCCCTCGAGCACGACAAGGCCTACGACCAGCAGCTCAA-AGCGGGTGACAATCCGTACCTGCG-GTATAACCACGCCGACGCCGAGTTTCAGGAGC-GTCTGCAAGAAGATACGTCTTTTGGGGGCAACCTCGGGCGAGCAGTCTTCCAGGCGAAAAAGAGGGTTCTTGAACCTCTGGGCCTGGTTGAGGAACCTGTTAAGACGGCTCCGGGAAAAAAGAGGCCGGTA-GAGCACTCTCCTGTG-GAGCCAGACTCCTCCTCGGGAACCGGAAAGGCGGGCCAGCAGCCCGCTAAAAAGAGACTCAATTTTGGTCAGACTGGCGACTC-AGAGTCAGTCCCCGACCCACAACCTCTCGGAGAACCTCCAGC--AACCC-CCGCTGCTGTGGGACCTACTACAATGGCTTCAGGCGGTGGCG-CACCAATGG-CAGACAATAACGAAGGCGCCGACGGAGTGGGTAATGCCTCGGGAGATTGGCATTGCGATTCCACGTGGATGGGGGACAGAGTCATCACCACCAG--CACCCGAACCTGGGCCCTGCCCACCTATAACAACCACCTCTAC-AAGCAAATCTCCAGTG-CTTCAA-CGGGGGCCA-GCAACGACAAC-CACTACTTCGGCTACAGCACCCCCTGGGGGTATTTTGATTTCAACAGATTCCACTGCCATTTCT-CACCACGTGACTGGCAGCGACTCATCAACAACAACTGGGGATTCCGACCCAAGAGACTCAACTTCAAGCTCTTCAACATCCAAGTCAAGGAGGTCACG-ACGAATGATGGCGTCACGACCATCGCTAATAACCTTACCAGCACGGTTCAGGTGTTTACTGACT-CGGAGTACCAGCTCCCGTACGTCCTCGGCT-CTGCGCACC-AGGGCTGCCTCCCT-CCGTTCCCGGCGGACGTGTTCATGATTCCGCAGTACGGCTACCTAACGCTCAACAATGGCAGC-CAGGCAGT---G--G-GACGGTCATCCTTTTACTGCCTGGAATATTTCCCATCGCA-GATGCTGAGAACGGGCAATAACTTTACCTTCAGCTACACCTTCGAGGACGTGCCTTTCCACAGCAGCTACGCGCACAGCCAGAGCCTGGACCGGCTGATGAATCCTCTCATCGACCAGTACCTGTATTACCT-GAACAGAACTCAGA-A-TC--AGTCCG-GAAGTGCC--CAAAA-CAAGGACTT--GCTGTTT-AG-CCGGGGGTCTCCAGCTGGCATGTCTGT-TCAGCCCAAAAACTGGCTACCTGGACCC-TGTTACCG---GCAGCAGC-GCGTTTCTAAAACAAAAACAGACAACAACAACAGCAACT-TTACCTGGACTG-GTGCTTCAAAATATAACCTTAATGGGC-GTGAATCTATAATCAACCCTGGCA-CTGCTATGGCCT-CACACAAAGACGACAAAGACA--AGTTCTT-T-CC-CATGAGCGGTGTCATGATTTTTGGAAAGG-AG--AGCG--CCGGAGCTT-CA--AACACTG-CATTG--GACAATGT-CATGATCAC-AGACGAAGAG-GAAATCAAAGCCACT-AACCCCGTGGC-CACCGAA-AGATTTG-GGACTG-TGGCAGTCAATCTCCAGAGCAGCAGCACAGACC--CTGCGACCGGAGATGT--GCA-TGTT-ATGGGAGC-CTTACCTGGAATG-GTGTGGCA-AGACAGAGACGTATACCTGCAGGGTCCTATTTGGGCCAAAATTCCTCACACGGATGG-ACACTTTCACCCGTCTCCTCTCATGGGCGGCTTTGGACTTAAGCACCCGCCTCCTCA-GATCCTCATCAAAAACACGCCTGTTCCTGCGAATCCTCCGGCAGAGTTT-TC-G-GC-TACAAAGTTTGCTTCATTCATCACCCAGTATTCCACAGGACAAGTGAGCGTGGAGATTGAATGGGAGCTGCA-GAAAGAAAACAGCAAACGCTGGAATCCCGAAGTGCAGTATACATCTAACTATG-CAAAATCTGCCAAC--GTTGATTTCACTGTGGACAACAATGGACTT-TATACTGAGCC-TC-GCCCCATTGGCACCCGTTACCTCACCCGTCCCCTGTAA"));
        ///
        crossover.CrossoverModel crossoverModel = crossover.CrossoverModel.getInstance(true, allSequences, false);
        List<SequenceDocument> parentsAsFullNucleotideSequences = crossoverModel.getParentsAsFullNucleotideSequences();
        SequenceDocument chimeraAsFullNucleotideSequence = crossoverModel.getChimeraAsFullNucleotideSequence();
        for (SequenceDocument s : parentsAsFullNucleotideSequences) {
            assertThat(s.getCharSequence().length(), is(crossoverModel.getChimera().length()));
        }
        postToUM(parentsAsFullNucleotideSequences, chimeraAsFullNucleotideSequence);
        crossoverModel.calculateStatisticsIfNotAlreadyIn();
        //
        assertThat(crossoverModel.getCrossoverDiscountingMutation(), is(9));
        //assertThat(crossoverModel.getCrossoverConsideringMutations(), is(9));
        assertThat(crossoverModel.getPointMutations(), is(0L));
        assertThat(crossoverModel.getLevenshteinDistances().get(0), is(393));
        assertThat(crossoverModel.getLevenshteinDistances().get(1), is(749));
        assertThat(crossoverModel.getLevenshteinDistances().get(2), is(42));
        ArrayList<Integer> fragments = crossoverModel.getUniqueLengthsUngappedFragments();
        assertThat(crossoverModel.getUniqueLengthsUngappedFragments(), is(Stream.of(362, 135, 177, 43, 38, 156, 39, 75, 45, 1141).collect(Collectors.toList())));
        double meanSizeOfFrag = fragments.stream().mapToInt(i -> i).average().getAsDouble();
        assertThat(meanSizeOfFrag, is(221.1));
    }

    @Test //real data
    public void testCrossoverStatisticsForChimera11AndWT256() throws Exception {//fine
        ArrayList<SequenceDocument> allSequences = new ArrayList<>();
        allSequences.add(new DefaultNucleotideSequence("wt2 Sequence", "ATGGCTGCCGATGGTTATCTTCCAGATTGGCTCGAGGACACTCTCTCTGAAGGAATAAGAC-AGTGGTGGAAGCTC-AAACCTGGC-CCACCACCACC-AAAGCCCGCAGAGCGGCATAAGGA-CGACAGCAGGGGTCTTGTGCTTCCTGGGTACAAGTACCTCGGACCCTTCAACGGACTCGA-CAAGGGAGAGCCGGTCAACGAGGCAGACGCCGCGGCCCTCGAGCACGACAAAGCCTACGACCGGCAGCTCGACAGCGG-A-GACAACCCGTACCT-CAAGTACAACCACGCCGACGCGGAGTTTCAGGAGCGCCTTAAAGAAGATACGTCTTTTGGGGGCAACCTCGGACGAGCAGTCTTCCAGGCGAAAAAGAGGGTTCTTGAACCTCTGGGCCTGGTTGAGGAACCTGTTAAGACGGCTCCGGGAAAAAAGAGGCCGGTA-GAGCACTCTCCTGTG-GAGCCAGACTCCTCCTCGGGAACCGGAAAGGCGGGCCAGCAGCCTGCAAGAAAAAGATTGAATTTTGGTCAGACTGGAGACGC-AGACTCAGTACCTGACCCCCAGCCTCTCGGACAGCCACCAGC--AGCCC-CCTCTGGTCTGGGAACTAATACGATGGCTACAGGCAGTGGCG-CACCAATGG-CAGACAATAACGAGGGCGCCGACGGAGTGGGTAATTCCTCGGGAAATTGGCATTGCGATTCCACATGGATGGGCGACAGAGTCATCACCACCAG--CACCCGAACCTGGGCCCTGCCCACCTACAACAACCACCTCTAC-AAACAAATTTCCA--G-C--CAATCAGGAGCCTCG-AACGACAAT-CACTACTTTGGCTACAGCACCCCTTGGGGGTATTTTGACTTCAACAGATTCCACTGCCACTTTT-CACCACGTGACTGGCAAAGACTCATCAACAACAACTGGGGATTCCGACCCAAGAGACTCAACTTCAAGCTCTTTAACATTCAAGTCAAAGAGGTCACGCA-GAATGACGGTACGACGACGATTGCCAATAACCTTACCAGCACGGTTCAGGTGTTTACTGACT-CGGAGTACCAGCTCCCGTACGTCCTCGGCT-CGGCGCATC-AAGGATGCCTCCCG-CCGTTCCCAGCAGACGTCTTCATGGTGCCACAGTATGGATACCTCACCCTGAACAACGGGAGT-CAGGCAGT---A--G-GACGCTCTTCATTTTACTGCCTGGAGTACTTTCCTTCTCA-GATGCTGCGTACCGGAAACAACTTTACCTTCAGCTACACTTTTGAGGACGTTCCTTTCCACAGCAGCTACGCTCACAGCCAGAGTCTGGACCGTCTCATGAATCCTCTCATCGACCAGTACCTGTATTACTT-GAGCAGAAC--AAACACTCCAAGT--G-GAACCACCA-CGCAGTCAAGG-CTTCAGTTTTCTCAGGCCGGAG----CGAG-TGACAT-TCGGGACCAGTCTAGGAACTGGCTTCCTGGACCC-TGTTACCG---CCAGCAGC-GAGTATCAAAGACATCTGCGGATAACAACAACAGTGAATACT-CGTGGACTG-GAGCTACCAAGTACCACCTCAATGG-CAGAGACTCTCTGGTGAATCCGGGCC-CGGCCATGGCAAGC-CACAAGGACGATGAAGAAA--AGTTTTT-T-CCTCA-GAGCGGGGTTCTCATCTTTGGGAAGC-AA--GGC---TCAGAGAAAACA--AATGTGGACATTG--AA-AAGGT-CATGATTAC-AGACGAAGAG-GAAATCAGGACAACC-AATCCCGTGGC-TACGGAGCAG-TATG-GTTCTG-TATCTACCAACCTCCAGAGAGGCA--ACAGACAAGCAGCTACCGCAGATGTCAACA-CAC--A-AGGCGTTCTT-CCAGGCATG-GTCTGGCA-GGACAGAGATGTGTACCTTCAGGGGCCCATCTGGGCAAAGATTCCACACACGGACGG-ACATTTTCACCCCTCTCCCCTCATGGGTGGATTCGGACTTAAACACCCTCCTCCACA-GATTCTCATCAAGAACACCCCGGTACCTGCGAATCCTTCGACC-A-CCT-TCAGTGC-GGCAAAGTTTGCTTCCTTCATCACACAGTACTCCACGGGACAGGTCAGCGTGGAGATCGAGTGGGAGCTGCA-GAAGGAAAACAGCAAACGCTGGAATCCCGAAATTCAGTACACTTCCAACTACAACAAG-TCTGTTAAT--GTGGACTTTACTGTGGACACTAATGG-CGTGTATTCAGAGCC-TC-GCCCCATTGGCACCAGATACCTGACTCGTAATCTGTAA"));
        allSequences.add(new DefaultNucleotideSequence("wt5 Sequence", "ATGTCTTTTGTTGATCACCCTCCAGATTGGTTGGAAGA-AGT-TGG-TGAAGGTCTTCG-CGAGTTTTTGGGCCTTGAAGCG-GGC-CCACCGAAACCAAAACCCAATC-AGCAGCATCAAGATCAA-GCCCGTGGTCTTGTGCTGCCTGGTTATAACTATCTCGGACCCGGAAACGGTCTCGATCGAGG-AGAGCCTGTCAACAGGGCAGACGAGGTCGCGCGAGAGCACGACATCTCGTACAACGAGCAGCTTGA-GGCGGGA-GACAACCCCTACCT-CAAGTACAACCACGCGGACGCCGAGTTTCAGGAGAAGCTCGCCGACGACACATCCTTCGGGGGAAACCTCGGAAAGGCAGTCTTTCAGGCCAAGAAAAGGGTTCTCGAACCTTTTGGCCTGGTTGAAGAGGGTGCTAAGACGGCCCCTACCGGAAAGCGGATAG-ACGACCACTTTCC-A-AAAAGAAAGAAGGCTC---GG--ACCG--AAGA--GG--A-C--TC--C----AAGCC-TTCCACCTCG-TCAGAC-GCCGAAGCTGGACCCAG---CGGATCC-CAGCAGCT-GCA-AATC-CCAGCCCAACCAGCCTCAAGTTTGGGAGCTGATACAATGTCTGCGGGAGGTGGCGGC-CCATTGGGC-GACAATAACCAAGGTGCCGATGGAGTGGGCAATGCCTCGGGAGATTGGCATTGCGATTCCACGTGGATGGGGGACAGAGTCGTCACCA--AGTCCACCCGAACCTGGGTGCTGCCCAGCTACAACAACCACCAGTACCGAG-AGATCAAAAGCGGCT-CCGTCGACGGA-A-GCAACGCCAACGC-CTACTTTGGATACAGCACCCCCTGGGGGTACTTTGACTTTAACCGCTTCCACAGCCACTGGAGCCCC-CGAGACTGGCAAAGACTCATCAACAACTACTGGGGCTTCAGACCCCGGTCCCTCAGAGTCAAAATCTTCAACATTCAAGTCAAAGAGGTCACG-GTGCAGGACTCCACCACCACCATCGCCAACAACCTCACCTCCACCGTCCAAGTGTTTACGGACGACG-ACTACCAGCTGCCCTACGTCGTCGGCAACGG-G-ACCGAGGGATGCCTGCCGGCC-TTCCCTCCGCAGGTCTTTACGCTGCCGCAGTACGGTTACGCGACGCTGAACCGCGACAACACAGAAAATCCCACCGAGAGGAGCAGCTTCTT-CTGCCTAGAGTACTTTCC-CAGCAAGATGCTGAGAACGGGCAACAACTTTGAGTTTACCTACAACTTTGAGGAGGTGCCCTTCCACTCCAGCTTCGCTCCCAGTCAGAACCTGTTCAAGCTGGCCAACCCGCTGGTGGACCAGTACTTGTACCGCTTCGTG-AGCAC--AAATA-AC--ACTG-GCGGAGT-CCAGTTCAA-CAAGAACCT--G--------G-CCGG-G------AGAT-ACGC--CAACACC--TACAAAAACTGGTTCCCGGGGCCCATGG-GCCGAACCCAG-GGCTG-GAACCTG-GGC-TCCGGGGTCAACCGCGCCAGTG-TCAGCGCCTTCGCCACGACCAATAGGATG-GAGCTCGA-GGGC-GCGAGTTACCAG-GTGCCCCCGCAGCCGA-ACGGCATG-AC-CAACAACCTCCAGGGCAGCAACACCTATGCCCTG-GAG-AACACTATGATCTTCA-ACAGCCAGCCGGCGAACCCGGGCAC-CACCGCCACGTACCTCGAGGGCAACATGC-TCATCACCAG-CGA-GAGCGAGA-CGCAGCCGGTGAACCGCGTGGCGTAC--AAC-G-TCGGCGGGCAGATGGCCACCAACAACCAGAGCTCCACCACTGCCC--CCGCGACCGGC-ACGT--ACAACCTCCA-GGAAAT-CGTGCCCGGCA-GCGTGTGG-ATGGAGAGGGACGTGTACCTCCAAGGACCCATCTGGGCCAAGATCCCAGAGACGGG-GGCGCACTTTCACCCCTCTCCGGCCATGGGCGGATTCGGACTCAAACACCCACCGCC-CATGATGCTCATCAAGAACACGCCTGTGCCCG-GAAATAT-C-ACC-AGCTTCTCGG-ACGTGCCC-GTCAGCAGC-TTCATCACCCAGTACAGCACCGGGCAGGTCACCGTGGAGATGGAGTGGGAGCT-CAAGAAGGAAAACTCCAAGAGGTGGAACCCAGAGATCCAGTACACAAACAACTACAACGA--CCC-CCAGTTTGTGGACTTTGCCCCGGACAGCACCGG--G-GAATACAGAACCACCAGACCTATCGGAACCCGATACCTTACCCGACCCCTTTAA"));
        allSequences.add(new DefaultNucleotideSequence("wt6 Sequence", "ATGGCTGCCGATGGTTATCTTCCAGATTGGCTCGAGGACAACCTCTCTGAGGGCATTCG-CGAGTGGTGGGA-CTTGAAACCTGGAGCC-CCGAAACCCAAAGCCAACC-AGCAAAAGCAGGA-CGACGGCCGGGGTCTGGTGCTTCCTGGCTACAAGTACCTCGGACCCTTCAACGGACTCGA-CAAGGGGGAGCCCGTCAACGCGGCGGATGCAGCGGCCCTCGAGCACGACAAGGCCTACGACCAGCAGCTCAA-AGCGG-GTGACAATCCGTACCTGCG-GTATAACCACGCCGACGCCGAGTTTCAGGAGCGTCTGCAAGAAGATACGTCTTTTGGGGGCAACCTCGGGCGAGCAGTCTTCCAGGCCAAGAAGAGGGTTCTCGAACCTTTTGGTCTGGTTGAGGAAGGTGCTAAGACGGCTCCTGGAAAGAAACGTCCGGTA-GAGCAGTCGCC-ACAAGAGCCAGACTCCTCCTCGGGCATTGGCAAGACAGGCCAGCAGCCCGCTAAAAAGAGACTCAATTTTGGTCAGACTGGCGACTC-AGAGTCAGTCCCCGACCCACAACCTCTCGGAGAACCTCCAGC--AACCC-CCGCTGCTGTGGGACCTACTACAATGGCTTCAGGCGGTGGCG-CACCAATGG-CAGACAATAACGAAGGCGCCGACGGAGTGGGTAATGCCTCAGGAAATTGGCATTGCGATTCCACATGGCTGGGCGACAGAGTCATCACCACCAG--CACCCGAACATGGGCCTTGCCCACCTATAACAACCACCTCTAC-AAGCAAATCTCCAGTG-CTTCAA-CGGGGGCCA-GCAACGACAAC-CACTACTTCGGCTACAGCACCCCCTGGGGGTATTTTGATTTCAACAGATTCCACTGCCATTTCT-CACCACGTGACTGGCAGCGACTCATCAACAACAATTGGGGATTCCGGCCCAAGAGACTCAACTTCAAGCTCTTCAACATCCAAGTCAAGGAGGTCACG-ACGAATGATGGCGTCACGACCATCGCTAATAACCTTACCAGCACGGTTCAAGTCTTCTCGGACT-CGGAGTACCAGTTGCCGTACGTCCTCGGCT-CTGCGCACC-AGGGCTGCCTCCCT-CCGTTCCCGGCGGACGTGTTCATGATTCCGCAGTACGGCTACCTAACGCTCAACAATGGCAGC-CAGGCAGT---G--G-GACGGTCATCCTTTTACTGCCTGGAATATTTCCCATCGCA-GATGCTGAGAACGGGCAATAACTTTACCTTCAGCTACACCTTCGAGGACGTGCCTTTCCACAGCAGCTACGCGCACAGCCAGAGCCTGGACCGGCTGATGAATCCTCTCATCGACCAGTACCTGTATTACCT-GAACAGAACTCAGA-A-TC--AGTCCG-GAAGTGCC--CAAAA-CAAGGACTT--GCTGTTT-AG-CCGGGGGTCTCCAGCTGGCATGTCTGT-TCAGCCCAAAAACTGGCTACCTGGACCC-TGTTACCG---GCAGCAGC-GCGTTTCTAAAACAAAAACAGACAACAACAACAGCAACT-TTACCTGGACTG-GTGCTTCAAAATATAACCTTAATGGGC-GTGAATCTATAATCAACCCTGGCA-CTGCTATGGCCT-CACACAAAGACGACAAAGACA--AGTTCTT-T-CC-CATGAGCGGTGTCATGATTTTTGGAAAGG-AG--AGCG--CCGGAGCTT-CA--AACACTG-CATTG--GACAATGT-CATGATCAC-AGACGAAGAG-GAAATCAAAGCCACT-AACCCCGTGGC-CACCGAA-AGATTTG-GGACTG-TGGCAGTCAATCTCCAGAGCAGCAGCACAGACC--CTGCGACCGGAGATGT--GCA-TGTT-ATGGGAGC-CTTACCTGGAATG-GTGTGGCA-AGACAGAGACGTATACCTGCAGGGTCCTATTTGGGCCAAAATTCCTCACACGGATGG-ACACTTTCACCCGTCTCCTCTCATGGGCGGCTTTGGACTTAAGCACCCGCCTCCTCA-GATCCTCATCAAAAACACGCCTGTTCCTGCGAATCCTCCGGCAGAGTTT-TC-G-GC-TACAAAGTTTGCTTCATTCATCACCCAGTATTCCACAGGACAAGTGAGCGTGGAGATTGAATGGGAGCTGCA-GAAAGAAAACAGCAAACGCTGGAATCCCGAAGTGCAGTATACATCTAACTATG-CAAAATCTGCCAAC--GTTGATTTCACTGTGGACAACAATGGACTT-TATACTGAGCC-TC-GCCCCATTGGCACCCGTTACCTCACCCGTCCCCTGTAA"));
        allSequences.add(new DefaultNucleotideSequence("Chimera 11 Sequence", "ATGACTTTTGTTGATCACCCTCCAGATTGGTTGGAAGA-AGT-TGG-TGAAGGTCTTCG-CGAGTTTTTGGGCCTTGAAGCG-GGC-CCACCGAAACCAAAACCCAATC-AGCAGCATCAAGATCAA-GCCCGTGGTCTTGTGCTGCCTGGTTATAACTATCTCGGACCCGGAAACGGTCTCGATCGAGG-AGAGCCTGTCAACGAGGCAGACGCCGCGGCCCTCGAGCACGACAAAGCCTACGACCGGCAGCTCGACAGCGG-A-GACAACCCGTACCT-CAAGTACAACCACGCCGACGCGGAGTTTCAGGAGCGCCTTAAAGAAGATACGTCTTTTGGGGGCAACCTCGGACGAGCAGTCTTCCAGGCCAAGAAGAGGGTTCTCGAACCTTTTGGCCTGGTTGAAGAGGGTGCTAAGACGGCCCCTACCGGAAAGCGGATAG-ACGACCACTTTCC-A-AAAAGAAAGAAGGCTC---GG--ACCG--AAGA--GG--A-C--TC--C----AAGCC-TTCCACCTCG-TCAGAC-GCCGAAGCTGGACCCAG---CGGATCC-CAGCAGCT-GCA-AATC-CCAGCCCAACCAGCCTCAAGTTTGGGAGCTGATACAATGTCTGCGGGAGGTGGCGGC-CCATTGGGC-GACAATAACCAAGGTGCCGATGGAGTGGGCAATGCCTCGGGAGATTGGCATTGCGATTCCACGTGGATGGGGGACAGAGTCGTCACCA--AGTCCACCCGAACCTGGGTGCTGCCCAGCTACAACAACCACCAGTACCGAG-AGATCAAAAGCGGCT-CCGTCGACGGA-A-GCAACGCCAACGC-CTACTTTGGATACAGCACCCCCTGGGGGTACTTTGACTTTAACCGCTTCCACAGCCACTGGAGCCCC-CGAGACTGGCAAAGACTCATCAACAACTACTGGGGCTTCAGACCCCGGTCCCTCAGAGTCAAAATCTTCAACATTCAAGTCAAAGAGGTCACG-GTGCAGGACTCCACCACCACCATCGCCAACAACCTCACCTCCACCGTCCAAGTGTTTACGGACGACG-ACTACCAGCTGCCCTACGTCGTCGGCAACGG-G-ACCGAGGGATGCCTGCCGGCC-TTCCCTCCGCAGGTCTTTACGCTGCCGCAGTACGGTTACGCGACGCTGAACCGCGACAACACAGAAAATCCCACCGAGAGGAGCAGCTTCTT-CTGCCTAGAGTACTTTCC-CAGCAAGATGCTGAGAACGGGCAACAACTTTGAGTTTACCTACAACTTTGAGGAGGTGCCCTTCCACTCCAGCTTCGCTCCCAGTCAGAACCTCTTCAAGCTGGCCAACCCGCTGGTGGACCAGTACTTGTACCGCTTCGTG-AGCAC--AAATA-AC--ACTG-GCGGAGT-CCAGTTCAA-CAAGAACCT--G--------G-CCGG-G------AGAT-ACGC--CAACACC--TACAAAAACTGGTTCCCGGGGCCCATGG-GCCGAACCCAG-GGCTG-GAACCTG-GGC-TCCGGGGTCAACCGCGCCAGTG-TCAGCGCCTTCGCCACGACCAATAGGATG-GAGCTCGA-GGGC-GCGAGTTACCAG-GTGCCCCCGCAGCCGA-ACGGCATG-AC-CAACAACCTCCAGGGCAGCAACACCTATGCCCTG-GAG-AACACTATGATCTTCA-ACAGCCAGCCGGCGAACCCGGGCAC-CACCGCCACGTACCTCGAGGGCAACATGC-TCATCACCAG-CGA-GAGCGAGA-CGCAGCCGGTGAACCGCGTGGCGTAC--AAC-G-TCGGCGGGCAGATGGCCACCAACAACCAGAGCTCCACCACTGCCC--CCGCGACCGGC-ACGT--ACAACCTCCA-GGAAAT-CGTGCCCGGCA-GCGTGTGG-ATGGAGAGGGACGTGTACCTCCAAGGACCCATCTGGGCCAAGATCCCAGAGACGGG-GGCGCACTTTCACCCCTCTCCGGCCATGGGCGGATTCGGACTCAAACACCCACCGCC-CATGATGCTCATCAAGAACACGCCTGTGCCCG-GAAATAT-C-ACC-AGCTTCTCGG-ACGTGCCC-GTCAGCAGC-TTCATCACCCAGTACAGCACCGGGCAGGTCACCGTGGAGATGGAGTGGGAGCT-CAAGAAGGAAAACTCCAAGAGGTGGAACCCAGAGATCCAGTACACAAACAACTACAACGA--CCC-CCAGTTTGTGGACTTTGCCCCGGACAGCACCGG--G-GAATACAGAAGCACCAGACCTATCGGAACCCGATACCTTACCCGACCCCTTTAA"));
        ///
        crossover.CrossoverModel crossoverModel = crossover.CrossoverModel.getInstance(true, allSequences, false);
        List<SequenceDocument> parentsAsFullNucleotideSequences = crossoverModel.getParentsAsFullNucleotideSequences();
        SequenceDocument chimeraAsFullNucleotideSequence = crossoverModel.getChimeraAsFullNucleotideSequence();
        parentsAsFullNucleotideSequences.forEach(s -> assertThat(s.getCharSequence().length(), is(crossoverModel.getChimera().length())));
        postToUM(parentsAsFullNucleotideSequences, chimeraAsFullNucleotideSequence);
        crossoverModel.calculateStatisticsIfNotAlreadyIn();
        //
        assertThat("Crossover discounting mutations", crossoverModel.getCrossoverDiscountingMutation(), is(3));
        // assertThat("Crossover considering mutations", crossoverModel.getCrossoverConsideringMutations(), is(6));
        assertThat("Mutations", crossoverModel.getPointMutations(), is(3L));
        assertThat("Lev", crossoverModel.getLevenshteinDistances().get(0), is(708));
        assertThat("Lev", crossoverModel.getLevenshteinDistances().get(1), is(44));
        assertThat("Lev", crossoverModel.getLevenshteinDistances().get(2), is(726));
        // ArrayList<Integer> fragments = crossoverModel.getUniqueLengthsUngappedFragments();
        // assertThat("Fragments", crossoverModel.getUniqueLengthsUngappedFragments(), is(Stream.of(3, 191, 164, 27, 882, 862, 43).collect(Collectors.toList())));
        // double meanSizeOfFrag = fragments.stream().mapToInt(i -> i).average().getAsDouble();
        //assertThat("Mean Size", meanSizeOfFrag, is(equalTo(310.2857142857143)));
    }

    @Test         //real data
    public void testCrossoverStatisticsForChimeraOpt256_7_388() throws Exception {//fine
        ArrayList<SequenceDocument> allSequences = new ArrayList<>();
        allSequences.add(new DefaultNucleotideSequence("aav2 opt", "ATGGCTGCCGATGGTTATCTTCCAGATTGGCTCGAGGACACTCTCTCTGAAGGCATTCGCCAGTGGTGGAAGTTGAAACCTGGA-CCACCGCCACCCAAACCCG-CAGAGCGGCATAAGGACGACAGC-CGGGGTCTTGTGCTTCCTGGTTACAAGTACCTCGGACCCTTCAACGGACTCGACAAGGGGGAGCCCGTCAACGAGGCGGACGCAGCGGCCCTCGAGCACGACAAGGCCTACGACCGGCAGCTCGACAGCGG-TGACAACCCGTACCTCAAGTACAACCACGCCGACGCCGAGTTTCAGGAGCGTCTGAAAGAAGATACGTCTTTTGGGGGCAACCTCGGGCGAGCAGTCTTCCAGGCCAAGAAGAGGGTTCTCGAACCTCTTGGTCTGGTTGAGGAACCTGTTAAGACGGCTCCTGGAAAGAAGCGTCCGGTA-GAGCACTCTCCAGTGGAGCCAGACTCCTCCTCGGGCACCGGCAAGGCGGGCCAGCAGCCCGCTAGAAAGAGACTCAATTTTGGTCAGAC-TGGCGACGCAGACTCAGTCCCCGACCCTCAACCTCTCGGACAGCCTCCAGCA--GCCC-CCTCTGGTTTGGGAACTAATACAATGGCTACAGGCAGTGGCG-CACCAATGG-CAGACAATAACGAAGGCGCCGACGGAGTGGGTAATTCCTCGGGAAATTGGCATTGCGATTCCACATGGATGGGCGACAGAGTCATCACCACCAGCACCCGAACCTGGGCCCTGCCCACCTACAACAACCACCTCTAC-AAGCAAATC---AGTAGC--CAATCAGGAGCCAGCAACGACAAC-CACTACTTCGGCTACAGCACCCCCTGGGGGTATTTTGACTTCAACAGATTCCACTGCCACTTCTCACCACGTGACTGGCAGCGACTCATCAACAACAACTGGGGATTCCGGCCCAAGAGACTCAACTTCAAGCTCTTCAACATCCAAGTCAAGGAGGTCACGCA-GAATGATGGCACGACGACCATCGCCAATAACCTTACCAGCACGGTTCAAGTGTTTACGGACT-CGGAGTACCAGCTCCCGTACGTCCTCGGCTCTGCGCACC-AGGGCTGCCTCCCT-CCGTTCCCGGCGGACGTCTTCATGGTGCCGCAGTACGGCTACCTGACGCTGAACAACGGCAGC-CAGG-----CCG-TGGGACGCTCATCCTTTTACTGCCTGGAATACTTCCCTTCGCAGATGCTGAGAACGGGCAACAACTTTACCTTCA-GCTACACCTTTGAGGACGTGCCTTTCCACAGCAGCTACGCTCACAGCCAGAGCCTGGACCGGCTGATGAATCCTCTCATCGACCAGTACCTGTACTACCT-GAGCAGAACT-AACACT-CCATCCGGAACCACCA-CGCAATCAAGG--TTGCAGTTTAGCCA--GGCCGGAGCGAGTGACAT-TCGGGACCAGTCTAGAAACTGGCTACCTGGACCC-TGTTACCGG-CAGCAGCGCGTTTCAA---AGACATCTGCGGACAACAACAACAGCG--AATAC-T-CGTGGACTGGTGCTACCAAATATCATCTCAATGGCCGTGACTCTCTGGTGAATCCTGGCCCGGCT--ATGGCCTCACACAAAGACGACGAAGAAA--AGTTCTT-T-CCCCA-GAGCGGTGTCCTCATTTTTGGCAAACAA--GGC---TCAGAGAAAACAAACGT--GGATAT-T---GAA-AAGGT-CATGATTACCGACGAAGAG-GAAATTAGGACCACT-AACCCTGTGGCC-ACGGAGCAG-TATGGGTCTG-TGTCTACCAACCTCCAGAGAGGCA--ACAGACAAGCAGCGACCGCAGATGT-CAACACACA-GGGAGTTTTACCTGGCATG-GTGTGGCA-AGACAGAGACGTGTACCTGCAGGGTCCCATTTGGGCCAAGATTCCTCACACGGATGG-ACACTTTCACCCGTCTCCG-CTGATGGGCGGCTTTGGACTGAAACACCCGCCTCCTCA-GATCCTCATCAAAAACACGCCTGTACCTGCGAATCCTTCGACCACCTTCAGCG-C-TGCAAAGTTTGCTTCATTCATCACCCAGTACTCCACTGGACAGGTCAGCGTGGAGATTGAGTGGGAGCTGCAGAAGGAAAACAGCAAGCGCTGGAATCCCGAGATCCAGTACACATCCAACTACAACAAA-TCT-GTTAATGTGGACTTTACTGTGGACACTAATGGAGTGTATAGTGAGC-CTCGCCCCATTGGCACCCGTTACCTCACCCGTAATCTGTAA"));
        allSequences.add(new DefaultNucleotideSequence("aav5 opt", "ATGTCTTTTGTTGATCACCCTCCAGATTGGCTCGAGGA-AGT-TGG-TGAAGGCCTTCGCGAGTTTTTGGGCTTGGAAGCGGGA-CCACCGAAACCCAAACCCAACC-AGCAACATCAGGACCA-AGCTCGGGGTCTTGTGCTTCCTGGTTACAACTACCTCGGACCCGGCAACGGACTCGACCGAGGGGAGCCCGTCAACAGGGCGGACGAGGTCGCCCGAGAGCACGACATCTCGTACAACGAGCAGCTCGA-GGCGGGTGACAACCCGTACCTCAAGTACAACCACGCCGACGCCGAGTTTCAGGAGAAGCTGGCCGACGATACGTCTTTTGGGGGCAACCTCGGGAAGGCAGTCTTCCAGGCCAAGAAGAGGGTTCTCGAACCTTTTGGTCTGGTTGAGGAAGGCGCTAAGACGGCTCCTACCGGAAAGCGTATAG-ACGATCACTTTCCA-AAAAGAAAGAAGGCT---CGG--ACCG--AAGA--GG--A----CTC-C----AAGCC-CTCCACCTCG-TCAGACGCAGAGGCT-GGACCCAG---CGGATCC-CAGCAGCT-GCAGA-TC-CCAGCACAACCCGCCTCTAGTTTGGGAGCTGATACAATGTCTGCAGGCGGTGGCGGC-CCATTGGGC-GACAATAACCAAGGCGCCGACGGAGTGGGTAATGCCTCGGGAGATTGGCATTGCGATTCCACATGGATGGGCGACAGAGTCGTCACCAAGAGCACCCGAACCTGGGTCCTGCCCAGCTACAACAACCACCAGTACCGAG-AGATCAAAAGTGGCT-CAGTCGACGGA-AGCAACGCCAACGC-CTACTTCGGCTACAGCACCCCCTGGGGGTATTTTGACTTCAACAGATTCCACAGCCACTGGTCACCACGTGACTGGCAGCGACTCATCAACAACTACTGGGGATTCCGGCCCCGGTCCCTCCGGGTCAAGATCTTCAACATCCAAGTCAAGGAGGTCACG-GTGCAGGATTCCACGACGACCATCGCCAATAACCTTACCAGCACGGTTCAAGTGTTTACGGACGACG-ACTACCAGCTCCCGTACGTCGTCGGCAACG-GTACCGAGGGCTGCCTCCCTGCC-TTCCCGCCGCAGGTCTTCACGCTGCCGCAGTACGGCTACGCGACGCTCAACCGCGACAACACAGAAAATCCCACTGAG-CGCTCATCCTTTTTCTGCCTGGAATACTTCCCTTCGAAGATGCTGAGAACGGGCAACAACTTTGAATTCACG-TACAACTTTGAGGAAGTGCCTTTCCACAGCAGCTTCGCTCCCAGCCAGAACCTGTTCAAGCTGGCCAATCCTCTCGTGGACCAGTACCTGTACCGCTTCGTGTCGA-CT-AACAATACTGGC-GGAG-T-CCAGTTTAA-CAAGA----AC---CTGGC-G--GG--GA---GA-T-ACGC--CAACACC--TACAAAAACTGGTTCCCTGGACCCATGG-GCCGGACC-CAG-G-GCTGGAACCTGGGC-TCTGGGGTCAACCGCGCCAGCGTCAGTGCCTTCGCC-AC-GAC-CAATAGGATG-GAGCTCGAGGGC-GCGAGT-TACCAGGTGCCCC--CTCAGCCGAACGGCATGACG-AACAACCTCCAGGGCAGCAACACCTATGCCCTG-GAG-AACACTATGATTTTTAACAGCCAGCCGGCGAACCCGGGCA--CAACCGCAACG-TACCTCGAGGGGAATATGC-TCATTACCAGCGAA-AGCGAAAC-GCAGCCGGTGAACCGCGTGGCCTACAACGTCG--GCGGG-CAGATGGCAACCAACAACCAGAGCAGCACCACAG-CT-CCTGCGACCGGA-ACTTACAACCTCCA-GGAAATCGTGCCTGGCA-GCGTGTGG-ATGGAGAGAGACGTGTACCTGCAGGGTCCCATTTGGGCCAAGATTCCTGAGACGGG-GGCGCACTTTCACCCGTCTCCGGCC-ATGGGCGGCTTTGGACTGAAACACCCGCCTCCT-ATGATGCTCATCAAAAACACGCCTGTACCTG-GAAATAT-C-ACCAGCTTCAGCGACGTGCCG-GTAAGCT-CATTCATCACCCAGTACTCCACTGGACAGGTCACCGTGGAGATGGAGTGGGAGCTGAAGAAGGAAAACAGCAAGCGCTGGAATCCCGAGATCCAGTACACAAACAACTACAACGACCCCCAGTT--TGTGGACTTTGCTCCCGACAGCACCGGAGAATATAG-AACCACCCGCCCCATTGGCACCCGTTACCTCACCCGTCCCCTGTAA"));
        allSequences.add(new DefaultNucleotideSequence("aav6 opt", "ATGGCTGCCGATGGTTATCTTCCAGATTGGCTCGAGGACAACCTCTCTGAAGGCATTCGCGAGTGGTGGGACTTGAAACCTGGAGCC-CCGAAACCCAAAGCCAACC-AGCAAAAGCAGGACGACGGC-CGGGGTCTTGTGCTTCCTGGTTACAAGTACCTCGGACCCTTCAACGGACTCGACAAGGGGGAGCCCGTCAACGCGGCGGACGCAGCGGCCCTCGAGCACGACAAGGCCTACGACCAGCAGCTCAA-GGCGGGTGACAACCCGTACCTCCGGTACAACCACGCCGACGCCGAGTTTCAGGAGCGTCTGCAAGAAGATACGTCTTTTGGGGGCAACCTCGGGCGAGCAGTCTTCCAGGCCAAGAAGAGGGTTCTCGAACCTTTTGGTCTGGTTGAGGAAGGCGCTAAGACGGCTCCTGGAAAGAAGCGTCCGGTA-GAGCAGTCTCCACAGGAGCCAGACTCCTCCTCGGGCATCGGCAAGACAGGCCAGCAGCCCGCTAAAAAGAGACTCAATTTTGGTCAGAC-TGGCGACTCAGAGTCAGTCCCCGACCCTCAACCTCTCGGAGAACCTCCAGCA--ACCC-CCGCTGCTGTGGGACCTACTACAATGGCTTCAGGCGGTGGCG-CACCAATGG-CAGACAATAACGAAGGCGCCGACGGAGTGGGTAATGCCTCGGGAAATTGGCATTGCGATTCCACATGGCTGGGCGACAGAGTCATCACCACCAGCACCCGAACCTGGGCCCTGCCCACCTACAACAACCACCTCTAC-AAGCAAATCTCCAGT-GCTTCAA-CGGGAGCCAGCAACGACAAC-CACTACTTCGGCTACAGCACCCCCTGGGGGTATTTTGACTTCAACAGATTCCACTGCCACTTCTCACCACGTGACTGGCAGCGACTCATCAACAACAACTGGGGATTCCGGCCCAAGAGACTCAACTTCAAGCTCTTCAACATCCAAGTCAAGGAGGTCACG-ACGAATGATGGCGTCACGACCATCGCCAATAACCTTACCAGCACGGTTCAAGTGTTTTCGGACT-CGGAGTACCAGCTCCCGTACGTCCTCGGCTCTGCGCACC-AGGGCTGCCTCCCT-CCGTTCCCGGCGGACGTCTTCATGATTCCGCAGTACGGCTACCTGACGCTGAACAACGGCAGC-CAGG-----CCG-TGGGACGCTCATCCTTTTACTGCCTGGAATACTTCCCTTCGCAGATGCTGAGAACGGGCAACAACTTTACCTTCA-GCTACACCTTTGAGGACGTGCCTTTCCACAGCAGCTACGCTCACAGCCAGAGCCTGGACCGGCTGATGAATCCTCTCATCGACCAGTACCTGTACTACCT-GAACAGAACTCAA-AAT-CAGTCCGGAAGTGCC--CAAAA-CAAGGACTTGCTGTTTAGCCGTGGGTCTC--CTGCTGGCATGTCTGT-TCAGCCCAAAAACTGGCTACCTGGACCC-TGTTACCGG-CAGCAGCGCGTTTCAA---AGACAAAAACAGACAACAACAACAGC---AACTT-TACCTGGACTGGTGCTTCAAAATATAACCTCAATGGCCGTGAATCTATCATCAATCCTGGCACTGCT--ATGGCCTCACACAAAGACGACAAAGACA--AGTTCTT-T-CCC-ATGAGCGGTGTCATGATTTTTGGCAAAGAG--AGCG--CCGGAGCTT-CAAACAC--TG-CAT-T---GGACAATGT-CATGATTACCGACGAAGAG-GAAATTAAAGCCACT-AACCCTGTGGCC-ACGGAG-AGATTTGGGACTG-TGGCAGTCAACCTCCAGAGCAGCAGCACAGAC--CCTGCGACCGGAGATGT-CCATGT-TATGGGAGCCTTACCTGGCATG-GTGTGGCA-AGACAGAGACGTGTACCTGCAGGGTCCCATTTGGGCCAAGATTCCTCACACGGATGG-ACACTTTCACCCGTCTCCG-CTGATGGGCGGCTTTGGACTGAAACACCCGCCTCCTCA-GATCCTCATCAAAAACACGCCTGTACCTGCGAATCCTCCGGCGGAGTTCAGCG-C-TACAAAGTTTGCTTCATTCATCACCCAGTACTCCACTGGACAGGTCAGCGTGGAGATTGAGTGGGAGCTGCAGAAGGAAAACAGCAAGCGCTGGAATCCCGAGGTGCAGTACACATCCAACTACG-CAAAATCT-GCCAATGTGGACTTTACTGTGGACAACAATGGACTTTATACTGAGC-CTCGCCCCATTGGCACCCGTTACCTCACCCGTCCCCTGTAA"));
        allSequences.add(new DefaultNucleotideSequence("ChimeraOpt256_7_388", "ATGGCTGCCGATGGTTATCTTCCAGATTGGCTCGAGGACACTCTCTCTGAAGGCATTCGCCAGTGGTGGAAGTTGAAACCTGGA-CCACCGCCACCCAAACCCG-CAGAGCGGCATAAGGACGACAGC-CGGGGTCTTGTGCTTCCTGGTTACAACTACCTCGGACCCGGCAACGGACTCGACCGAGGGGAGCCCGTCAACAGGGCGGACGAGGTCGCCCGAGAGCACGACATCTCGTACAACGAGCAGCTCAA-GGCGGGTGACAACCCGTACCTCCGGTACAACCACGCCGACGCCGAGTTTCAGGAGCGTCTGCAAGAAGATACGTCTTTTGGGGGCAACCTCGGGAAGGCAGTCTTCCAGGCCAAGAAGAGGGTTCTCGAACCTTTTGGTCTGGTTGAGGAAGGCGCTAAGACGGCTCCTGGAAAGAAGCGTCCGGTA-GAGCACTCTCCAGTGGAGCCAGACTCCTCCTCGGGCACCGGCAAGGCGGGCCAGCAGCCCGCTAGAAAGAGACTCAATTTTGGTCAGAC-TGGCGACTCAGAGTCAGTCCCCGACCCTCAACCTCTCGGAGAACCTCCAGCA--ACCC-CCGCTGCTGTGGGACCTACTACAATGGCTTCAGGCGGTGGCG-CACCAATGG-CAGACAATAACGAAGGCGCCGACGGAGTGGGTAATGCCTCGGGAAATTGGCATTGCGATTCCACATGGCTGGGCGACAGAGTCATCACCACCAGCACCCGAACCTGGGCCCTGCCCAGCTACAACAACCACCTCTAC-AAGCAAATCTCCAGT-GCTTCAA-CGGGAGCCAGCAACGACAAC-CACTACTTCGGCTACAGCACCCCCTGGGGGTATTTTGACTTCAACAGATTCCACAGCCACTGGTCACCACGTGACTGGCAGCGACTCATCAACAACTACTGGGGATTCCGGCCCAAGAGACTCAACTTCAAGCTCTTCAACATCCAAGTCAAGGAGGTCACGCA-GAATGATGGCACGACGACCATCGCCAATAACCTTACCAGCACGGTTCAAGTGTTTACGGACGACG-ACTACCAGCTCCCGTACGTCGTCGGCAACG-GTACCGAGGGCTGCCTCCCTGCC-TTCCCGCCGCAGGTCTTCACGCTGCCGCAGTACGGTTACGGGACGTTCAACCGGGACAACACAGAAAATCCCACTGAG-CGCTCATCCTTTTTCTGCCTGGAATACTTCCCTTCGAAGATGCTGAGAACGGGCAACAACTTTGAATTCACG-TACAACTTTGAGGAAGTGCCTTTCCACAGCAGCTACGCTCACAGCCAGAGCCTGGACCGGCTGATGAATCCTCTCATCGACCAGTACCTGTACTACCT-GAACAGAACT-AACACT-CCATCCGGAACCACCA-CGCAATCAAGG--TTGCAGTTTAGCCA--GGCCGGAGCGAGTGACAT-TCGGGACCAGTCTAGAAACTGGCTACCTGGACCC-TGTTACCGG-CAGCAGCGCGTTTCAA---AGACATCTGCGGACAACAACAACAGCG--AATAC-T-CGTGGACTGGTGCTACCAAATATCATCTCAATGGCCGTGAATCTATCATCAATCCTGGCACTGCT--ATGGCCTCACACAAAGACGACAAAGACA--AGTTCTT-T-CCCCA-GAGCGGTGTCATGATTTTTGGCAAAGAG--AGCG--CCGGAGCTT-CAAACAC--TG-CAT-T---GGACAATGT-CATGATTACCGACGAAGAG-GAAATTAAAGCCACT-AACCCTGTGGCC-ACGGAG-AGATTTGGGACTG-TGGCAGTCAACCTCCAGAGCAGCAGCACAGAC--CCTGCGACCGGAGATGT-CCATGT-TATGGGAGCCTTACCTGGCATG-GTGTGGCA-AGACAGAGACGTGTACCTGCAGGGTCCCATTTGGGCCAAGATTCCTGAGACGGG-GGCGCACTTTCACCCGTCTCCG-CTGATGGGCGGCTTTGGACTGAAACACCCGCCTCCTCA-GATCCTCATCAAAAACACGCCTGTACCTGCGAATCCTTCGACCACCTTCAGCG-C-TACAAAGTTTGCTTCATTCATCACCCAGTACTCCACTGGACAGGTCAGCGTGGAGATTGAGTGGGAGCTGCAGAAGGAAAACAGCAAGCGCTGGAATCCCGAGATCCAGTACACATCCAACTACAACAAA-TCT-GTTAATGTGGACTTTGCTCCCGACAGCACCGGAGAATATAG-AACCACCCGCCCCATTGGCACCCGTTACCTCACCCGTCCCCTGTAA"));
        ///
        crossover.CrossoverModel crossoverModel = crossover.CrossoverModel.getInstance(true, allSequences, false);
        List<SequenceDocument> parentsAsFullNucleotideSequences = crossoverModel.getParentsAsFullNucleotideSequences();
        SequenceDocument chimeraAsFullNucleotideSequence = crossoverModel.getChimeraAsFullNucleotideSequence();
        parentsAsFullNucleotideSequences.forEach(s -> assertThat(s.getCharSequence().length(), is(crossoverModel.getChimera().length())));
        postToUM(parentsAsFullNucleotideSequences, chimeraAsFullNucleotideSequence);
        crossoverModel.calculateStatisticsIfNotAlreadyIn();
        //
        assertThat("Crossover discounting mutations", crossoverModel.getCrossoverDiscountingMutation(), is(20));//same as UofM
        // assertThat("Crossover considering mutations", crossoverModel.getCrossoverConsideringMutations(), is(6));
        assertThat("Mutations", crossoverModel.getPointMutations(), is(4L));
        assertThat("Lev", crossoverModel.getLevenshteinDistances().get(0), is(193));
        assertThat("Lev", crossoverModel.getLevenshteinDistances().get(1), is(457));
        assertThat("Lev", crossoverModel.getLevenshteinDistances().get(2), is(196));
        // ArrayList<Integer> fragments = crossoverModel.getUniqueLengthsUngappedFragments();
        // assertThat("Fragments", crossoverModel.getUniqueLengthsUngappedFragments(), is(Stream.of(3, 191, 164, 27, 882, 862, 43).collect(Collectors.toList())));
        // double meanSizeOfFrag = fragments.stream().mapToInt(i -> i).average().getAsDouble();
        //assertThat("Mean Size", meanSizeOfFrag, is(equalTo(310.2857142857143)));
    }

    @Test
    public void testCrossoverStatisticsForChimeraOpt256_4_388() throws Exception { //fine for crossover they get mutations and I don't. switch A
        ArrayList<SequenceDocument> allSequences = new ArrayList<>();
        allSequences.add(new DefaultNucleotideSequence("chimeraOpt256_4_388Sequence", "ATGGCTGCCGATGGTTATCTTCCAGATTGGCTCGAGGACACTCTCTCTGAAGGCATTCGCCAGTGGTGGAAGTTGAAACCTGGA-CCACCGCCACCCAAACCCG-CAGAGCGGCATAAGGACGACAGC-CGGGGTCTTGTGCTTCCTGGTTACAAGTACCTCGGACCCTTCAACGGACTCGACAAGGGGGAGCCCGTCAACGAGGCGGACGCAGCGGCCCTCGAGCACGACAAGGCCTACGACCGGCAGCTCGACAGCGG-TGACAACCCGTACCTCAAGTACAACCACGCCGACGCCGAGTTTCAGGAGCGTCTGAAAGAAGATACGTCTTTTGGGGGCAACCTCGGGCGAGCAGTCTTCCAGGCCAAGAAGAGGGTTCTCGAACCTCTTGGTCTGGTTGAGGAACCTGTTAAGACGGCTCCTGGAAAGAAGCGTCCGGTA-GAGCACTCTCCAGTGGAGCCAGACTCCTCCTCGGGCACCGGCAAGGCGGGCCAGCAGCCCGCTAGAAAGAGACTCAATTTTGGTCAGAC-TGGCGACGCAGACTCAGTCCCCGACCCTCAACCTCTCGGACAGCCTCCAGCA--GCCC-CCTCTGGTTTGGGAACTAATACAATGGCTACAGGCAGTGGCG-CACCAATGG-CAGACAATAACGAAGGCGCCGACGGAGTGGGTAATTCCTCGGGAAATTGGCATTGCGATTCCACATGGATGGGCGACAGAGTCATCACCACCAGCACCCGAACCTGGGCCCTGCCCACCTACAACAACCACCTCTAC-AAGCAAATC---AGTAGC--CAATCAGGAGCCAGCAACGACAAC-CACTACTTCGGCTACAGCACCCCCTGGGGGTATTTTGACTTCAACAGATTCCACTGCCACTTCTCACCACGTGACTGGCAGCGACTCATCAACAACAACTGGGGATTCCGGCCCAAGAGACTCAACTTCAAGCTCTTCAACATCCAAGTCAAGGAGGTCACGCA-GAATGATGGCACGACGACCATCGCCAATAACCTTACCAGCACGGTTCAAGTGTTTACGGACT-CGGAGTACCAGCTCCCGTACGTCCTCGGCTCTGCGCACC-AGGGCTGCCTCCCT-CCGTTCCCGGCGGACGTCTTCATGGTGCCGCAGTACGGCTACCTGACGCTGAACAACGGCAGC-CAGG-----CCG-TGGGACGCTCATCCTTTTACTGCCTGGAATACTTCCCTTCGCAGATGCTGAGAACGGGCAACAACTTTACCTTCAGC-TACACCTTTGAGGACGTGCCTTTCCACAGCAGCTACGCTCACAGCCAGAGCCTGGACCGGCTGATGAATCCTCTCATCGACCAGTACCTGTACTACCT-GAGCAGAACT-AACACT-CCATCCGGAACCACCA-CGCAATCAAGG--TTGCAGTTTAGCCA--GGCCGGAGCGAGTGACAT-TCGGGACCAGTCTAGAAACTGGCTACCTGGACCC-TGTTACCGG-CAGCAGCGCGTTTCAA---AGACATCTGCGGACAACAACAACAGCG--AATAC-T-CGTGGACTGGTGCTACCAAATATCATCTCAATGGCCGTGACTCTCT-GGTGAATCCT-GGCCCGGCTATGGCCTCACACAAAGACGACGAAGAAA--AGTTCTT-T-CCCCA-GAGCGGTGTCCTCATTTTTGGCAAACAA--GGC---TCAGAGAA-AAC-A-AACGTGGATATTGAA---AAGGT-CATGATTACCGACGAAGAG-GAAATTAGGACCACT-AACCCTGTGGCC-ACGGAGCAG-TATGGGTCTG-TGTCTACCAACCTCCAGAGAGGCA--ACAGACAAGCAGCGACCGCAGATGT-CAACACACA-GGGAGTTTTACCTGGCATG-GTGTGGCA-AGACAGAGACGTGTACCTGCAGGGTCCCATTTGGGCCAAGATTCCTCACACGGATGG-ACACTTTCACCCGTCTCCG-CTGATGGGCGGCTTTGGACTGAAACACCCGCCTCCTCA-GATCCTCATCAAAAACACGCCTGTACCTGCGAATCCTTCGACCACCTTCAGCG-C-TGCAAAGTTTGCTTCATTCATCACCCAGTACTCCACTGGACAGGTCAGCGTGGAGATTGAGTGGGAGCTGCAGAAGGAAAACAGCAAGCGCTGGAATCCCGAGATCCAGTACACATCCAACTACAACAAA-TCT-GTTAATGTGGACTTTACTGTGGACACTAATGGAGTGTATAGTGAGC-CTCGCCCCATTGGCACCCGTTACCTCACCCGTAATCTGTAA"));
        allSequences.add(new DefaultNucleotideSequence("aa2 opt Sequence", "ATGTCTTTTGTTGATCACCCTCCAGATTGGCTCGAGGA-AGT-TGG-TGAAGGCCTTCGCGAGTTTTTGGGCTTGGAAGCGGGA-CCACCGAAACCCAAACCCAACC-AGCAACATCAGGACCA-AGCTCGGGGTCTTGTGCTTCCTGGTTACAACTACCTCGGACCCGGCAACGGACTCGACCGAGGGGAGCCCGTCAACAGGGCGGACGAGGTCGCCCGAGAGCACGACATCTCGTACAACGAGCAGCTCGA-GGCGGGTGACAACCCGTACCTCAAGTACAACCACGCCGACGCCGAGTTTCAGGAGAAGCTGGCCGACGATACGTCTTTTGGGGGCAACCTCGGGAAGGCAGTCTTCCAGGCCAAGAAGAGGGTTCTCGAACCTTTTGGTCTGGTTGAGGAAGGCGCTAAGACGGCTCCTACCGGAAAGCGTATAG-ACGATCACTTTCCA-AAAAGAAAGAAGGC---TCGG--ACCG--AAGA--GG-----A-CTC-C----AAGCC-CTCCACCTCG-TCAGACGCAGAGGCT-GGACCCAG---CGGATCC-CAGCAGCT-GCAGA-TC-CCAGCACAACCCGCCTCTAGTTTGGGAGCTGATACAATGTCTGCAGGCGGTGGCGGC-CCATTGGGC-GACAATAACCAAGGCGCCGACGGAGTGGGTAATGCCTCGGGAGATTGGCATTGCGATTCCACATGGATGGGCGACAGAGTCGTCACCAAGAGCACCCGAACCTGGGTCCTGCCCAGCTACAACAACCACCAGTACCGAG-AGATCAAAAGTGGCT-CAGTCGACGGA-AGCAACGCCAACGC-CTACTTCGGCTACAGCACCCCCTGGGGGTATTTTGACTTCAACAGATTCCACAGCCACTGGTCACCACGTGACTGGCAGCGACTCATCAACAACTACTGGGGATTCCGGCCCCGGTCCCTCCGGGTCAAGATCTTCAACATCCAAGTCAAGGAGGTCACG-GTGCAGGATTCCACGACGACCATCGCCAATAACCTTACCAGCACGGTTCAAGTGTTTACGGACGACG-ACTACCAGCTCCCGTACGTCGTCGGCAACG-GTACCGAGGGCTGCCTCCCTGCC-TTCCCGCCGCAGGTCTTCACGCTGCCGCAGTACGGCTACGCGACGCTCAACCGCGACAACACAGAAAATCCCACTGAG-CGCTCATCCTTTTTCTGCCTGGAATACTTCCCTTCGAAGATGCTGAGAACGGGCAACAACTTTGAATTCA-CGTACAACTTTGAGGAAGTGCCTTTCCACAGCAGCTTCGCTCCCAGCCAGAACCTGTTCAAGCTGGCCAATCCTCTCGTGGACCAGTACCTGTACCGCTTCGTGTCGA-CT-AACAATACTGGC-GGA-GT-CCAGTTTAA-CAAGAACCTG--GC--GG--G-GAGA-TA--C-GCCAACAC--C----T-A--C-AAAAACTGGTTCCCTGGACCCATGG-GCCGGACC-CAG-G-GCTGGAACCTGGGC-TCTGGGGTCAACCGCGCCAGCGTCAGTGCCTTCGCC-AC-GAC-CAATAGGATG-GAGCTCGAGGGC-GCGAGTTACCAGGTGCCCCCTCAGC-CGA--ACGGCATGACG-AACAACCTCCAGGGCAGCAACACCTATGCCCTG-GAG-AACACTATGATTTTTAACAGCCAGCCGGCGAACCCGGGCACAACCGCAACGT-A-CCTCGAGGGGAATATGC-TCATTACCAGCGAA-AGCGAAAC-GCAGCCGGTGAACCGCGTGGCCTACAACGTCG--GCGGG-CAGATGGCAACCAACAACCAGAGCAGCACCACAG-CT-CCTGCGACCGGA-ACTTACAACCTCCA-GGAAATCGTGCCTGGCA-GCGTGTGG-ATGGAGAGAGACGTGTACCTGCAGGGTCCCATTTGGGCCAAGATTCCTGAGACGGG-GGCGCACTTTCACCCGTCTCCGGCC-ATGGGCGGCTTTGGACTGAAACACCCGCCTCCT-ATGATGCTCATCAAAAACACGCCTGTACCTG-GAAATAT-C-ACCAGCTTCAGCGACGTGCCG-GTAAGCT-CATTCATCACCCAGTACTCCACTGGACAGGTCACCGTGGAGATGGAGTGGGAGCTGAAGAAGGAAAACAGCAAGCGCTGGAATCCCGAGATCCAGTACACAAACAACTACAACGACCCCCAGTT--TGTGGACTTTGCTCCCGACAGCACCGGAGAATATAG-AACCACCCGCCCCATTGGCACCCGTTACCTCACCCGTCCCCTGTAA"));
        allSequences.add(new DefaultNucleotideSequence("aav6 opt Sequence", "ATGGCTGCCGATGGTTATCTTCCAGATTGGCTCGAGGACAACCTCTCTGAAGGCATTCGCGAGTGGTGGGACTTGAAACCTGGAGCC-CCGAAACCCAAAGCCAACC-AGCAAAAGCAGGACGACGGC-CGGGGTCTTGTGCTTCCTGGTTACAAGTACCTCGGACCCTTCAACGGACTCGACAAGGGGGAGCCCGTCAACGCGGCGGACGCAGCGGCCCTCGAGCACGACAAGGCCTACGACCAGCAGCTCAA-GGCGGGTGACAACCCGTACCTCCGGTACAACCACGCCGACGCCGAGTTTCAGGAGCGTCTGCAAGAAGATACGTCTTTTGGGGGCAACCTCGGGCGAGCAGTCTTCCAGGCCAAGAAGAGGGTTCTCGAACCTTTTGGTCTGGTTGAGGAAGGCGCTAAGACGGCTCCTGGAAAGAAGCGTCCGGTA-GAGCAGTCTCCACAGGAGCCAGACTCCTCCTCGGGCATCGGCAAGACAGGCCAGCAGCCCGCTAAAAAGAGACTCAATTTTGGTCAGAC-TGGCGACTCAGAGTCAGTCCCCGACCCTCAACCTCTCGGAGAACCTCCAGCA--ACCC-CCGCTGCTGTGGGACCTACTACAATGGCTTCAGGCGGTGGCG-CACCAATGG-CAGACAATAACGAAGGCGCCGACGGAGTGGGTAATGCCTCGGGAAATTGGCATTGCGATTCCACATGGCTGGGCGACAGAGTCATCACCACCAGCACCCGAACCTGGGCCCTGCCCACCTACAACAACCACCTCTAC-AAGCAAATCTCCAGT-GCTTCAA-CGGGAGCCAGCAACGACAAC-CACTACTTCGGCTACAGCACCCCCTGGGGGTATTTTGACTTCAACAGATTCCACTGCCACTTCTCACCACGTGACTGGCAGCGACTCATCAACAACAACTGGGGATTCCGGCCCAAGAGACTCAACTTCAAGCTCTTCAACATCCAAGTCAAGGAGGTCACG-ACGAATGATGGCGTCACGACCATCGCCAATAACCTTACCAGCACGGTTCAAGTGTTTTCGGACT-CGGAGTACCAGCTCCCGTACGTCCTCGGCTCTGCGCACC-AGGGCTGCCTCCCT-CCGTTCCCGGCGGACGTCTTCATGATTCCGCAGTACGGCTACCTGACGCTGAACAACGGCAGC-CAGG-----CCG-TGGGACGCTCATCCTTTTACTGCCTGGAATACTTCCCTTCGCAGATGCTGAGAACGGGCAACAACTTTACCTTCAGC-TACACCTTTGAGGACGTGCCTTTCCACAGCAGCTACGCTCACAGCCAGAGCCTGGACCGGCTGATGAATCCTCTCATCGACCAGTACCTGTACTACCT-GAACAGAACTCAA-AAT-CAGTCCGGAAGTGCC--CAAAA-CAAGGACTTGCTGTTTAGCCGTGGGTCTC--CTGCTGGCATGTCTGT-TCAGCCCAAAAACTGGCTACCTGGACCC-TGTTACCGG-CAGCAGCGCGTTTCAA---AGACAAAAACAGACAACAACAACAGC---AACTT-TACCTGGACTGGTGCTTCAAAATATAACCTCAATGGCCGTGAATCTAT-CATCAATCCT-GGCACTGCTATGGCCTCACACAAAGACGACAAAGACA--AGTTCTT-T-CCC-ATGAGCGGTGTCATGATTTTTGGCAAAGAG--AGCG--CCGGAGCT-T-C-A-AACACTG-CATTGGAC--AATGT-CATGATTACCGACGAAGAG-GAAATTAAAGCCACT-AACCCTGTGGCC-ACGGAG-AGATTTGGGACTG-TGGCAGTCAACCTCCAGAGCAGCAGCACAGAC--CCTGCGACCGGAGATGT-CCATGT-TATGGGAGCCTTACCTGGCATG-GTGTGGCA-AGACAGAGACGTGTACCTGCAGGGTCCCATTTGGGCCAAGATTCCTCACACGGATGG-ACACTTTCACCCGTCTCCG-CTGATGGGCGGCTTTGGACTGAAACACCCGCCTCCTCA-GATCCTCATCAAAAACACGCCTGTACCTGCGAATCCTCCGGCGGAGTTCAGCG-C-TACAAAGTTTGCTTCATTCATCACCCAGTACTCCACTGGACAGGTCAGCGTGGAGATTGAGTGGGAGCTGCAGAAGGAAAACAGCAAGCGCTGGAATCCCGAGGTGCAGTACACATCCAACTACG-CAAAATCT-GCCAATGTGGACTTTACTGTGGACAACAATGGACTTTATACTGAGC-CTCGCCCCATTGGCACCCGTTACCTCACCCGTCCCCTGTAA"));
        allSequences.add(new DefaultNucleotideSequence("chimeraOpt256_4_388Sequence", "ATGGCTGCCGATGGTTATCTTCCAGATTGGCTCGAGGA-AGT-TGG-TGAAGGCCTTCGCGAGTTTTTGGGCTTGGAAGCGGGA-CCACCGAAACCCAAACCCAACC-AGCAACATCAGGACCA-AGCTCGGGGTCTTGTGCTTCCTGGTTACAACTACCTCGGACCCGGCAACGGACTCGACCGAGGGGAGCCCGTCAACGAGGCGGACGCAGCGGCCCTCGAGCACGACAAGGCCTACGACCAGCAGCTCAA-GGCGGGTGACAACCCGTACCTCCGGTACAACCACGCCGACGCCGAGTTTCAGGAGAAGCTGGCCGACGATACGTCTTTTGGGGGCAACCTCGGGCGAGCAGTCTTCCAGGCCAAGAAGAGGGTTCTCGAACCTCTTGGTCTGGTTGAGGAAGGCGCTAAGACGGCTCCTGGAAAGAAGCGTCCGGTA-GAGCACTCTCCAGTGGAGCCAGACTCCTCCTCGGGCACCGGCAAGGCGGGCCAGCAGCCCGCTAGAAAGAGACTCAATTTTGGTCAGAC-TGGCGACTCAGAGTCAGTCCCCGACCCTCAACCTCTCGGAGAACCTCCAGCA--ACCC-CCGCTGCTGTGGGACCTACTACAATGGCTTCAGGCGGTGGCG-CACCAATGG-CAGACAATAACGAAGGCGCCGACGGAGTGGGTAATGCCTCGGGAAATTGGCATTGCGATTCCACATGGATGGGCGACAGAGTCATCACCACCAGCACCCGAACCTGGGCCCTGCCCACCTACAACAACCACCTCTAC-AAGCAAATCTCCAGT-GCTTCAA-CGGGAGCCAGCAACGCCAACGC-CTACTTCGGCTACAGCACCCCCTGGGGGTATTTTGACTTCAACAGATTCCACTGCCACTTCTCACCACGTGACTGGCAGCGACTCATCAACAACAACTGGGGATTCCGGCCCAAGAGACTCAACTTCAAGCTCTTCAACATCCAAGTCAAGGAGGTCACG-ACGAATGATGGCGTCACGACCATCGCCAATAACCTTACCAGCACGGTTCAAGTGTTTTCGGACT-CGGAGTACCAGCTCCCGTACGTCGTCGGCAACG-GTACCGAGGGCTGCCTCCCTGCC-TTCCCGCCGCAGGTCTTCACGCTGCCGCAGTACGGCTACGCGACGCTCAACCGCGACAACACAGAAAATCCCACTGAG-CGCTCATCCTTTTTCTGCCTGGAATACTTCCCTTCGCAGATGCTGAGAACGGGCAACAACTTTACCTTCAGC-TACACCTTTGAGGACGTGCCTTTCCACAGCAGCTACGCTCACAGCCAGAGCCTGGACCGGCTGATGAATCCTCTCATCGACCAGTACCTGTACTACCT-GAACAGAACTCAA-AAT-CAGTCCGGAAGTGCC--CAAAA-CAAGGACTTGCTGTTTAGCCGTGGGTCTC--CTGCTGGCATGTCTGT-TCAGCCCAAAAACTGGCTACCTGGACCC-TGTTACCGG-CAGCAGCGCGTTTCAA---AGACATCTGCGGACAACAACAACAGCG--AATAC-T-CGTGGACTGGTGCTACCAAATATCATCTCAATGGCCGTGACTCTCT-GGTGAATCCT-GGCCCGGCTATGGCCTCACACAAAGACGACGAAGAAA--AGTTCTT-T-CCCCA-GAGCGGTGTCCTCATTTTTGGCAAACAA--GGC---TCAGAGAA-AAC-A-AACGTGGATATTGAA---AAGGT-CATGATTACCGACGAAGAG-GAAATTAGGACCACT-AACCCTGTGGCC-ACGGAGCAG-TATGGGTCTG-TGTCTACCAACCTCCAGAGAGGCA--ACAGACAAGCAGCGACCGCAGATGT-CAACACACA-GGGAGTTTTACCTGGCATG-GTGTGGCA-AGACAGAGACGTGTACCTGCAGGGTCCCATTTGGGCCAAGATTCCTCACACGGATGG-ACACTTTCACCCGTCTCCG-CTGATGGGCGGCTTTGGACTGAAACACCCGCCTCCTCA-GATCCTCATCAAAAACACGCCTGTACCTGCGAATCCTTCGACCACCTTCAGCG-C-TGCAAAGTTTGCTTCATTCATCACCCAGTACTCCACTGGACAGGTCAGCGTGGAGATTGAGTGGGAGCTGCAGAAGGAAAACAGCAAGCGCTGGAATCCCGAGATCCAGTACACATCCAACTACAACAAA-TCT-GTTAATGTGGACTTTACTGTGGACACTAATGGAGTGTATAGTGAGC-CTCGCCCCATTGGCACCCGTTACCTCACCCGTCCCCTGTAA"));
        ///
        crossover.CrossoverModel crossoverModel = crossover.CrossoverModel.getInstance(true, allSequences, false);
        List<SequenceDocument> parentsAsFullNucleotideSequences = crossoverModel.getParentsAsFullNucleotideSequences();
        SequenceDocument chimeraAsFullNucleotideSequence = crossoverModel.getChimeraAsFullNucleotideSequence();
        parentsAsFullNucleotideSequences.forEach(s -> assertThat(s.getCharSequence().length(), is(crossoverModel.getChimera().length())));
        postToUM(parentsAsFullNucleotideSequences, chimeraAsFullNucleotideSequence);
        crossoverModel.calculateStatisticsIfNotAlreadyIn();
        //
        assertThat("Crossover discounting mutations", crossoverModel.getCrossoverDiscountingMutation(), is(16));//matches UofM
        //assertThat("Crossover considering mutations", crossoverModel.getCrossoverConsideringMutations(), is(17));//todo check manually. It's probably wrong because there are 0 mutations
        assertThat("Mutations", crossoverModel.getPointMutations(), is(0L));//UofM has 5 mutations due to incorrect alignment
        assertThat("Lev", crossoverModel.getLevenshteinDistances().get(0), is(154));//UofM 176
        assertThat("Lev", crossoverModel.getLevenshteinDistances().get(1), is(479));//UofM 576
        assertThat("Lev", crossoverModel.getLevenshteinDistances().get(2), is(176)); //UofM 189
        ArrayList<Integer> fragments = crossoverModel.getUniqueLengthsUngappedFragments();
//        assertThat("Fragments", crossoverModel.getUniqueLengthsUngappedFragments(), is(Stream.of(3, 191, 164, 27, 882, 862, 43).collect(Collectors.toList())));
//        double meanSizeOfFrag = fragments.stream().mapToInt(i -> i).average().getAsDouble();
//        assertThat("Mean Size", meanSizeOfFrag, is(equalTo(310.2857142857143)));
    }

    //covers all types of switch es
    @Test // no match Crossover: 23 ± 0 per chimera    Point mutations: 54 ± 0 per chimera    (Mean ± S.D.) BAD switch at 1836 should not exist
    public void testCrossoverStatisticsForChimeraOpt256_11_388() throws Exception { // I removed some chars from the beginning of 10 TODO I don't know if this matches with anything ans UofM seems to have a different alignment
        //real data. note the sequences have already been aligned and contain gaps
        ArrayList<SequenceDocument> allSequences = new ArrayList<>();
        allSequences.add(new DefaultNucleotideSequence("aav2 opt", "ATGGCTGCCGATGGTTATCTTCCAGATTGGCTCGAGGACACTCTCTCTGAAGGCATTCGCCAGTGGTGGAAGTTGAAACCTGGA-CCACCGCCACCCAAACCCG-CAGAGCGGCATAAGGACGACAGC-CGGGGTCTTGTGCTTCCTGGTTACAAGTACCTCGGACCCTTCAACGGACTCGACAAGGGGGAGCCCGTCAACGAGGCGGACGCAGCGGCCCTCGAGCACGACAAGGCCTACGACCGGCAGCTCGACAGCGG-TGACAACCCGTACCTCAAGTACAACCACGCCGACGCCGAGTTTCAGGAGCGTCTGAAAGAAGATACGTCTTTTGGGGGCAACCTCGGGCGAGCAGTCTTCCAGGCCAAGAAGAGGGTTCTCGAACCTCTTGGTCTGGTTGAGGAACCTGTTAAGACGGCTCCTGGAAAGAAGCGTCCGGTA-GAGCACTCTCCAGTGGAGCCAGACTCCTCCTCGGGCACCGGCAAGGCGGGCCAGCAGCCCGCTAGAAAGAGACTCAATTTTGGTCAGAC-TGGCGACGCAGACTCAGTCCCCGACCCTCAACCTCTCGGACAGCCTCCAGCA--GCCC-CCTCTGGTTTGGGAACTAATACAATGGCTACAGGCAGTGGCG-CACCAATGG-CAGACAATAACGAAGGCGCCGACGGAGTGGGTAATTCCTCGGGAAATTGGCATTGCGATTCCACATGGATGGGCGACAGAGTCATCACCACCAGCACCCGAACCTGGGCCCTGCCCACCTACAACAACCACCTCTAC-AAGCAAATC---AGTAGC--CAATCAGGAGCCAGCAACGACAAC-CACTACTTCGGCTACAGCACCCCCTGGGGGTATTTTGACTTCAACAGATTCCACTGCCACTTCTCACCACGTGACTGGCAGCGACTCATCAACAACAACTGGGGATTCCGGCCCAAGAGACTCAACTTCAAGCTCTTCAACATCCAAGTCAAGGAGGTCACGCA-GAATGATGGCACGACGACCATCGCCAATAACCTTACCAGCACGGTTCAAGTGTTTACGGACT-CGGAGTACCAGCTCCCGTACGTCCTCGGCTCTGCGCACC-AGGGCTGCCTCCCT-CCGTTCCCGGCGGACGTCTTCATGGTGCCGCAGTACGGCTACCTGACGCTGAACAACGGCAGC-CAGG-----CCG-TGGGACGCTCATCCTTTTACTGCCTGGAATACTTCCCTTCGCAGATGCTGAGAACGGGCAACAACTTTACCTTCA-GCTACACCTTTGAGGACGTGCCTTTCCACAGCAGCTACGCTCACAGCCAGAGCCTGGACCGGCTGATGAATCCTCTCATCGACCAGTACCTGTACTACCT-GAGCAGAACT-AACACT-CCATCCGGAACCACCA-CGCAATCAAGG--TTGCAGTTTAGCCA--GGCCGGAGCGAGTGACAT-TCGGGACCAGTCTAGAAACTGGCTACCTGGACCC-TGTTACCGG-CAGCAGCGCGTTTCAA---AGACATCTGCGGACAACAACAACAGCGAATACT-CGTGGACTGGTGCTACCA-AATATC-ATCTCAATGGCCGTGACTCTCTGGTGAATCCTGGCCCGGCT--ATGGCCTCACACAAAGACGACGAAGAAA--AGTTCTT-T-CCCCA-GAGCGGTGTCCTCATTTTTGGCAAACAA--GGC---TCAGAGAA-AAC-A-AACGTGGATATTGAA---AAGGT-CATGATTACCGACGAAGAG-GAAATTAGGACCACT-AACCCTGTGGCC-ACGGAGCAG-TATGGGTCTG-TGTCTACCAACCTCCAGAGAGGCA--ACAGACAAGCAGCGACCGCAGATGTCAACACACA-GGGAGTTTTACCTGGCATG-GTGTGGCAAGACAGAGACGTGTACCTGCAGGGTCCCATTTGGGCCAAGATTCCTCACACGGATGG-ACACTTTCACCCGTCTCCG-CTGATGGGCGGCTTTGGACTGAAACACCCGCCTCCTCA-GATCCTCATCAAAAACACGCCTGTACCTGCGAATCCTTCGACCACCTTCAGCG-C-TGCAAAGTTTGCTTCATTCATCACCCAGTACTCCACTGGACAGGTCAGCGTGGAGATTGAGTGGGAGCTGCAGAAGGAAAACAGCAAGCGCTGGAATCCCGAGATCCAGTACACATCCAACTACAACAAA-TCT-GTTAATGTGGACTTTACTGTGGACACTAATGGAGTGTATAGTGAGC-CTCGCCCCATTGGCACCCGTTACCTCACCCGTAATCTGTAA"));
        allSequences.add(new DefaultNucleotideSequence("aav5 opt", "ATGTCTTTTGTTGATCACCCTCCAGATTGGCTCGAGGA-AGT-TGG-TGAAGGCCTTCGCGAGTTTTTGGGCTTGGAAGCGGGA-CCACCGAAACCCAAACCCAACC-AGCAACATCAGGACCA-AGCTCGGGGTCTTGTGCTTCCTGGTTACAACTACCTCGGACCCGGCAACGGACTCGACCGAGGGGAGCCCGTCAACAGGGCGGACGAGGTCGCCCGAGAGCACGACATCTCGTACAACGAGCAGCTCGA-GGCGGGTGACAACCCGTACCTCAAGTACAACCACGCCGACGCCGAGTTTCAGGAGAAGCTGGCCGACGATACGTCTTTTGGGGGCAACCTCGGGAAGGCAGTCTTCCAGGCCAAGAAGAGGGTTCTCGAACCTTTTGGTCTGGTTGAGGAAGGCGCTAAGACGGCTCCTACCGGAAAGCGTATAG-ACGATCACTTTCCA-AAAAGAAAGAAGGCT---CGG--ACCG--AAGA--GG--A----CTC-C----AAGCC-CTCCACCTCG-TCAGACGCAGAGGCT-GGACCCAG---CGGATCC-CAGCAGCT-GCAGA-TC-CCAGCACAACCCGCCTCTAGTTTGGGAGCTGATACAATGTCTGCAGGCGGTGGCGGC-CCATTGGGC-GACAATAACCAAGGCGCCGACGGAGTGGGTAATGCCTCGGGAGATTGGCATTGCGATTCCACATGGATGGGCGACAGAGTCGTCACCAAGAGCACCCGAACCTGGGTCCTGCCCAGCTACAACAACCACCAGTACCGAG-AGATCAAAAGTGGCT-CAGTCGACGGA-AGCAACGCCAACGC-CTACTTCGGCTACAGCACCCCCTGGGGGTATTTTGACTTCAACAGATTCCACAGCCACTGGTCACCACGTGACTGGCAGCGACTCATCAACAACTACTGGGGATTCCGGCCCCGGTCCCTCCGGGTCAAGATCTTCAACATCCAAGTCAAGGAGGTCACG-GTGCAGGATTCCACGACGACCATCGCCAATAACCTTACCAGCACGGTTCAAGTGTTTACGGACGACG-ACTACCAGCTCCCGTACGTCGTCGGCAACG-GTACCGAGGGCTGCCTCCCTGCC-TTCCCGCCGCAGGTCTTCACGCTGCCGCAGTACGGCTACGCGACGCTCAACCGCGACAACACAGAAAATCCCACTGAG-CGCTCATCCTTTTTCTGCCTGGAATACTTCCCTTCGAAGATGCTGAGAACGGGCAACAACTTTGAATTCACG-TACAACTTTGAGGAAGTGCCTTTCCACAGCAGCTTCGCTCCCAGCCAGAACCTGTTCAAGCTGGCCAATCCTCTCGTGGACCAGTACCTGTACCGCTTCGTGTCGA-CT-AACAATACTGGC-GGAG-T-CCAGTTTAA-CAAGA----AC---CTGGC-G--GG--GA---GA-T-ACGC--CAACACC--TACAAAAACTGGTTCCCTGGACCCATGG-GCCGGACC-CAG-G-GCTGGAACCTGGGC-TCTGGGGTCAACCGCGCCAGC-GTCAGTGCCTTCGCCA-CGAC-CAATAGGATGGAGCTCGAGGGC-GCGAGT-TACCAGGTGCCCC--CTCAGCCGAACGGCATGACG-AACAACCTCCAGGGCAGCAACACCTATGCCCTG-GAG-AACACTATGATTTTTAACAGCCAGCCGGCGAACCCGGGCACAACCGCAACGT-A-CCTCGAGGGGAATATGC-TCATTACCAGCGAA-AGCGAAAC-GCAGCCGGTGAACCGCGTGGCCTACAACGTCG--GCGGG-CAGATGGCAACCAACAACCAGAGCAGCACCACA-GCT-CCTGCGACCGGAACTTACAACCTCCA-GGAAATCGTGCCTGGCA-GCGTGTGGATGGAGAGAGACGTGTACCTGCAGGGTCCCATTTGGGCCAAGATTCCTGAGACGGG-GGCGCACTTTCACCCGTCTCCGGCC-ATGGGCGGCTTTGGACTGAAACACCCGCCTCCT-ATGATGCTCATCAAAAACACGCCTGTACCTG-GAAATAT-C-ACCAGCTTCAGCGACGTGCCG-GTAAGCT-CATTCATCACCCAGTACTCCACTGGACAGGTCACCGTGGAGATGGAGTGGGAGCTGAAGAAGGAAAACAGCAAGCGCTGGAATCCCGAGATCCAGTACACAAACAACTACAACGACCCCCAGTT--TGTGGACTTTGCTCCCGACAGCACCGGAGAATATAG-AACCACCCGCCCCATTGGCACCCGTTACCTCACCCGTCCCCTGTAA"));
        allSequences.add(new DefaultNucleotideSequence("aav6 opt", "ATGGCTGCCGATGGTTATCTTCCAGATTGGCTCGAGGACAACCTCTCTGAAGGCATTCGCGAGTGGTGGGACTTGAAACCTGGAGCC-CCGAAACCCAAAGCCAACC-AGCAAAAGCAGGACGACGGC-CGGGGTCTTGTGCTTCCTGGTTACAAGTACCTCGGACCCTTCAACGGACTCGACAAGGGGGAGCCCGTCAACGCGGCGGACGCAGCGGCCCTCGAGCACGACAAGGCCTACGACCAGCAGCTCAA-GGCGGGTGACAACCCGTACCTCCGGTACAACCACGCCGACGCCGAGTTTCAGGAGCGTCTGCAAGAAGATACGTCTTTTGGGGGCAACCTCGGGCGAGCAGTCTTCCAGGCCAAGAAGAGGGTTCTCGAACCTTTTGGTCTGGTTGAGGAAGGCGCTAAGACGGCTCCTGGAAAGAAGCGTCCGGTA-GAGCAGTCTCCACAGGAGCCAGACTCCTCCTCGGGCATCGGCAAGACAGGCCAGCAGCCCGCTAAAAAGAGACTCAATTTTGGTCAGAC-TGGCGACTCAGAGTCAGTCCCCGACCCTCAACCTCTCGGAGAACCTCCAGCA--ACCC-CCGCTGCTGTGGGACCTACTACAATGGCTTCAGGCGGTGGCG-CACCAATGG-CAGACAATAACGAAGGCGCCGACGGAGTGGGTAATGCCTCGGGAAATTGGCATTGCGATTCCACATGGCTGGGCGACAGAGTCATCACCACCAGCACCCGAACCTGGGCCCTGCCCACCTACAACAACCACCTCTAC-AAGCAAATCTCCAGT-GCTTCAA-CGGGAGCCAGCAACGACAAC-CACTACTTCGGCTACAGCACCCCCTGGGGGTATTTTGACTTCAACAGATTCCACTGCCACTTCTCACCACGTGACTGGCAGCGACTCATCAACAACAACTGGGGATTCCGGCCCAAGAGACTCAACTTCAAGCTCTTCAACATCCAAGTCAAGGAGGTCACG-ACGAATGATGGCGTCACGACCATCGCCAATAACCTTACCAGCACGGTTCAAGTGTTTTCGGACT-CGGAGTACCAGCTCCCGTACGTCCTCGGCTCTGCGCACC-AGGGCTGCCTCCCT-CCGTTCCCGGCGGACGTCTTCATGATTCCGCAGTACGGCTACCTGACGCTGAACAACGGCAGC-CAGG-----CCG-TGGGACGCTCATCCTTTTACTGCCTGGAATACTTCCCTTCGCAGATGCTGAGAACGGGCAACAACTTTACCTTCA-GCTACACCTTTGAGGACGTGCCTTTCCACAGCAGCTACGCTCACAGCCAGAGCCTGGACCGGCTGATGAATCCTCTCATCGACCAGTACCTGTACTACCT-GAACAGAACTCAA-AAT-CAGTCCGGAAGTGCC--CAAAA-CAAGGACTTGCTGTTTAGCCGTGGGTCTC--CTGCTGGCATGTCTGT-TCAGCCCAAAAACTGGCTACCTGGACCC-TGTTACCGG-CAGCAGCGCGTTTCAA---AGACAAAAACAGACAACAACAACAGC-AACTTTACCTGGACTGGTGCTTCAA-AATATA-ACCTCAATGGCCGTGAATCTATCATCAATCCTGGCACTGCT--ATGGCCTCACACAAAGACGACAAAGACA--AGTTCTT-T-CCC-ATGAGCGGTGTCATGATTTTTGGCAAAGAG--AGCG--CCGGAGCT-T-C-A-AACACTG-CATTGGAC--AATGT-CATGATTACCGACGAAGAG-GAAATTAAAGCCACT-AACCCTGTGGCC-ACGGAG-AGATTTGGGACTG-TGGCAGTCAACCTCCAGAGCAGCAGCACAGAC--CCTGCGACCGGAGATGTCCATGT-TATGGGAGCCTTACCTGGCATG-GTGTGGCAAGACAGAGACGTGTACCTGCAGGGTCCCATTTGGGCCAAGATTCCTCACACGGATGG-ACACTTTCACCCGTCTCCG-CTGATGGGCGGCTTTGGACTGAAACACCCGCCTCCTCA-GATCCTCATCAAAAACACGCCTGTACCTGCGAATCCTCCGGCGGAGTTCAGCG-C-TACAAAGTTTGCTTCATTCATCACCCAGTACTCCACTGGACAGGTCAGCGTGGAGATTGAGTGGGAGCTGCAGAAGGAAAACAGCAAGCGCTGGAATCCCGAGGTGCAGTACACATCCAACTACG-CAAAATCT-GCCAATGTGGACTTTACTGTGGACAACAATGGACTTTATACTGAGC-CTCGCCCCATTGGCACCCGTTACCTCACCCGTCCCCTGTAA"));
        allSequences.add(new DefaultNucleotideSequence("chimeraOpt256_11_388", "ATGGCTGCCGATGGTTATCTTCCAGATTGGCTCGAGGACACTCTCTCTGAAGGCATTCGCGAGTGGTGGGACTTGAAACCTGGAGCC-CCGAAACCCAAAGCCAACC-AGCAAAAGCAGGACGACGGC-CGGGGTCTTGTGCTTCCTGGTTACAAGTACCTCGGACCCTTCAACGGACTCGACAAGGGGGAGCCCGTCAACGAGGCGGACGCAGCGGCCCTCGAGCACGACAAGGCCTACGACCGGCAGCTCGACAGCGG-TGACAACCCGTACCTCAAGTACAACCACGCCGACGCCGAGTTTCAGGAGAAGCTGGCCGACGATACGTCTTTTGGGGGCAACCTCGGGAAGGCAGTCTTCCAGGCCAAGAAGAGGGTTCTCGAACCTTTTGGTCTGGTTGAGGAAGGCGCTAAGACGGCTCCTGGAAAGAAGCGTCCGGTA-GAGCACTCTCCAGTGGAGCCAGACTCCTCCTCGGGCATCGGCAAGACAGGCCAGCAGCCCGCTAGAAAGAGACTCAATTTTGGTCAGAC-TGGCGACTCAGAGTCAGTCCCCGACCCTCAACCTCTCGGAGAACCTCCAGCA--ACCC-CCGCTGCTGTGGGACCTACTACAATGGCTTCAGGCGGTGGCG-CACCAATGG-CAGACAATAACGAAGGCGCCGACGGAGTGGGTAATGCCTCGGGAAATTGGCATTGCGATTCCACATGGATGGGCGACAGAGTCGTCACCAAGAGCACCCGAACCTGGGTCCTGCCCAGCTACAACAACCACCAGTACCGAG-AGATCAAAAGTGGCT-CAGTCGACGGA-AGCAACGACAAC-CACTACTTCGGCTACAGCACCCCCTGGGGGTATTTTGACTTCAACAGATTCCACAGCCACTGGTCACCACGTGACTGGCAGCGACTCATCAACAACAACTGGGGATTCCGGCCCCGGTCCCTCCGGGTCAAGATCTTCAACATCCAAGTCAAGGAGGTCACG-ACGAATGATGGCGTCCCGACCATCGCCAATAACCTTACCAGCACGGTTCAAGTGTTTTCGGACT-CGGAATACCAGCTCCCGTACGTCCTCGGCAACG-GTACCGAGGGCTGCCTCCCTGCC-TTCCCGCCGCAGGTCTTCACGCTGCCGCAGTACGGTTACGGGACGTTCAACCGGGACAACACAGAAAATCCCACTGAG-CGCTCATCCTTTTTCTGCCTGGAATACTTCCCTTCGAAGATGCTGAGAACGGGCAACAACTTTGAATTCACG-TACAACTTTGAGGAAGTGCCTTTCCACAGCAGTTTGGTTCCCAGCCAGAGCCTGGACCGGCTGATGAATCCTTTCATCGACCAGTACCTGTACTACCT-GAACAGAACT-AACACT-CCATCCGGAACCACCA-CGCAATCAAGG--TTGCAGTTTAGCCA--GGCCGGAGCGAGTGACAT-TCGGGACCAGTCTAGAAACTGGCTACCTGGACCC-TGTTACCGG-CAGCAGCGCGTTTCAA---AGACAAAAACAGACAACAACAACAGC-AACTTTACCTGGACTGGTGCTTCAA-AATATA-ACCTCAATGGCCGTGAATCTATCATCAATCCTGGCACTGCT--ATGGCCTCACACAAAGACGACGAAGAAA--AGTTCTT-T-CCCCA-GAGCGGTGTCCTCATTTTTGGCAAACAA--GGC---TCAGAGAA-AAC-A-AACGTGGATATTGAA---AAGGT-CATGATTACCGACGAAGAG-GAAATTAAAGCCACT-AACCCTGTGGCC-ACGGAG-AGATTTGGGACTG-TGGCAGTCAACCTCCAG----G-A--A---AT---C-GTG-CC-----TG-----GC--A-----GC---G--TG---TG-G-ATGG--AGA--GAGACGTGTACCTGCAGGGTCCCATTTGGGCCAAGATTCCTCACACGGATGG-ACACTTTCACCCGTCTCCG-CTGATGGGCGGCTTTGGACTGAAACACCCGCCTCCTCA-GATCCTCATCAAAAACACGCCTGTACCTGCGAATCCTTCGACCACCTTCAGCG-C-TGCAAAGTTTGCTTCATTCATCACCCAGTACTCCACTGGACAGGTCAGCGTGGAGATTGAGTGGGAGCTGAAGAAGGAAAACAGCAAGCGCTGGAATCCCGAGATCCAGTACACAAACAACTACAACGACCCCCAGTT--TGTGGACTTTGCTCCCGACAGCACCGGAGAATATAG-AACCACCCGCCCCATTGGCACCCGTTACCTCACCCGTAATCTGTAA"));
        ///
        crossover.CrossoverModel crossoverModel = crossover.CrossoverModel.getInstance(true, allSequences, false);
        List<SequenceDocument> parentsAsFullNucleotideSequences = crossoverModel.getParentsAsFullNucleotideSequences();
        SequenceDocument chimeraAsFullNucleotideSequence = crossoverModel.getChimeraAsFullNucleotideSequence();
        parentsAsFullNucleotideSequences.forEach(s -> assertThat(s.getCharSequence().length(), is(crossoverModel.getChimera().length())));
        postToUM(parentsAsFullNucleotideSequences, chimeraAsFullNucleotideSequence);
        crossoverModel.calculateStatisticsIfNotAlreadyIn();
        assertThat(crossoverModel.getSwitches().toString(), is(equalTo(switchExpectationFor11)));
        //
        assertThat("Crossover discounting mutations", crossoverModel.getCrossoverDiscountingMutation(), is(25));//UofM is 23
        //assertThat("Crossover considering mutations", crossoverModel.getCrossoverConsideringMutations(), is(33));//todo check manually. It's probably wrong because there are 0 mutations
        assertThat("Mutations", crossoverModel.getPointMutations(), is(13L));//UofM has 5 mutations due to incorrect alignment
        assertThat("Lev", crossoverModel.getLevenshteinDistances().get(0), is(247));//UofM 176
        assertThat("Lev", crossoverModel.getLevenshteinDistances().get(1), is(449));//UofM 576
        assertThat("Lev", crossoverModel.getLevenshteinDistances().get(2), is(255)); //UofM 189
        ArrayList<Integer> fragments = crossoverModel.getUniqueLengthsUngappedFragments();
//        assertThat("Fragments", crossoverModel.getUniqueLengthsUngappedFragments(), is(Stream.of(3, 191, 164, 27, 882, 862, 43).collect(Collectors.toList())));
//        double meanSizeOfFrag = fragments.stream().mapToInt(i -> i).average().getAsDouble();
//        assertThat("Mean Size", meanSizeOfFrag, is(equalTo(310.2857142857143)));
    }

    @Test //does NOT match - a lot of mutations including one that's not a point mutation
    public void testCrossoverStatisticsForChimeraOpt256_10_388() throws Exception { // I removed some chars from the beginning of 10 TODO I don't know if this matches with anything ans UofM seems to have a different alignment
        ArrayList<SequenceDocument> allSequences = new ArrayList<>();
        allSequences.add(new DefaultNucleotideSequence("aav2 opt", "ATGGCTGCCGATGGTTATCTTCCAGATTGGCTCGAGGACACTCTCTCTGAAGGCATTCGCCAGTGGTGGAAGTTGAAACCTGGA-CCACCGCCACCCAAACCCG-CAGAGCGGCATAAGGACGACAGC-CGGGGTCTTGTGCTTCCTGGTTACAAGTACCTCGGACCCTTCAACGGACTCGACAAGGGGGAGCCCGTCAACGAGGCGGACGCAGCGGCCCTCGAGCACGACAAGGCCTACGACCGGCAGCTCGACAGCGG-TGACAACCCGTACCTCAAGTACAACCACGCCGACGCCGAGTTTCAGGAGCGTCTGAAAGAAGATACGTCTTTTGGGGGCAACCTCGGGCGAGCAGTCTTCCAGGCCAAGAAGAGGGTTCTCGAACCTCTTGGTCTGGTTGAGGAACCTGTTAAGACGGCTCCTGGAAAGAAGCGTCCGGTA-GAGCACTCTCCAGTGGAGCCAGACTCCTCCTCGGGCACCGGCAAGGCGGGCCAGCAGCCCGCTAGAAAGAGACTCAATTTTGGTCAGAC-TGGCGACGCAGACTCAGTCCCCGACCCTCAACCTCTCGGACAGCCTCCAGCA--GCCC-CCTCTGGTTTGGGAACTAATACAATGGCTACAGGCAGTGGCG-CACCAATGG-CAGACAATAACGAAGGCGCCGACGGAGTGGGTAATTCCTCGGGAAATTGGCATTGCGATTCCACATGGATGGGCGACAGAGTCATCACCACCAGCACCCGAACCTGGGCCCTGCCCACCTACAACAACCACCTCTAC-AAGCAAATC---AGTAGC--CAATCAGGAGCCAGCAACGACAAC-CACTACTTCGGCTACAGCACCCCCTGGGGGTATTTTGACTTCAACAGATTCCACTGCCACTTCTCACCACGTGACTGGCAGCGACTCATCAACAACAACTGGGGATTCCGGCCCAAGAGACTCAACTTCAAGCTCTTCAACATCCAAGTCAAGGAGGTCACGCA-GAATGATGGCACGACGACCATCGCCAATAACCTTACCAGCACGGTTCAAGTGTTTACGGACT-CGGAGTACCAGCTCCCGTACGTCCTCGGCTCTGCGC-ACC-AGGGCTGCCTCCCT-CCGTTCCCGGCGGACGTCTTCATGGTGCCGCAGTACGGCTACCTGACGCTGAACAACGGCAGC-CAGGCCGTGG----------GA-CGCTCATCCTTTTACTGCCTGGAATACTTCCCTTCGCAGATGCTGAGAACGGGCAACAACTTTACCTTCA-GCTACACCTTTGAGGACGTGCCTTTCCACAGCAGCTACGCTCACAGCCAGAGCCTGGACCGGCTGATGAATCCTCTCATCGACCAGTACCTGTACTACCT-GAGCAGAACT-AACACT-CCATCCGGAACCACCA-CGCAATCAAGG--TTGCAGTTTAGCCA--GGCCGGAGCGAGTGACAT-TCGGGACCAGTCTAGAAACTGGCTACCTGGACCC-TGTTACCGGCAGC-AGCGCGTTTCAA---AGACATCTGCGGACAACAACAACAGCGAATACT-CGTGGACTGGTGCTACCA-AATATC-ATCTCAATGGCCGTGACTCTCTGGTGAATCCTGGCCCGGCT--ATGGCCTCACACAAAGACGACGAAGAAA--AGTTCTT-T-CCCCA-GAGCGGTGTCCTCATTTTTGGCAAACAA--GGC---TCAGAGAA-AAC-A-AACGTGGATATTGAA---AAGGT-CATGATTACCGACGAAGAG-GAAATTAGGACCACT-AACCCTGTGGCC-ACGGAGCAG-TATGGGTCTG-TGTCTACCAACCTCCAGAGAGGCA--ACAGACAAGCAGCGACCGCAGATGT-CAACACACA-GGGAGTTTTACCTGGCATG-GTGTGGCA-AGACAGAGACGTGTACCTGCAGGGTCCCATTTGGGCCAAGATTCCTCACACGGATGG-ACACTTTCACCCGTCTCCG-CTGATGGGCGGCTTTGGACTGAAACACCCGCCTCCTCA-GATCCTCATCAAAAACACGCCTGTACCTGCGAATCCTTCGACCACCTTCAGCG-C-TGCAAAGTTTGCTTCATTCATCACCCAGTACTCCACTGGACAGGTCAGCGTGGAGATTGAGTGGGAGCTGCAGAAGGAAAACAGCAAGCGCTGGAATCCCGAGATCCAGTACACATCCAACTACAACAAA-TCTGTTAAT--GTGGACTTTACTGTGGACACTAATGGAGTGTATAGTGAGC-CTCGCCCCATTGGCACCCGTTACCTCACCCGTAATCTGTAA"));
        allSequences.add(new DefaultNucleotideSequence("aav5 opt", "ATGTCTTTTGTTGATCACCCTCCAGATTGGCTCGAGGA-AGT-TGG-TGAAGGCCTTCGCGAGTTTTTGGGCTTGGAAGCGGGA-CCACCGAAACCCAAACCCAACC-AGCAACATCAGGACCA-AGCTCGGGGTCTTGTGCTTCCTGGTTACAACTACCTCGGACCCGGCAACGGACTCGACCGAGGGGAGCCCGTCAACAGGGCGGACGAGGTCGCCCGAGAGCACGACATCTCGTACAACGAGCAGCTCGA-GGCGGGTGACAACCCGTACCTCAAGTACAACCACGCCGACGCCGAGTTTCAGGAGAAGCTGGCCGACGATACGTCTTTTGGGGGCAACCTCGGGAAGGCAGTCTTCCAGGCCAAGAAGAGGGTTCTCGAACCTTTTGGTCTGGTTGAGGAAGGCGCTAAGACGGCTCCTACCGGAAAGCGTATAG-ACGATCACTTTCCA-AAAAGAAAGAAGGCTC----GG-ACCG--AAG--AGG--A-C--TCC------AAGCC-CTCCACCTCG-TCAGACGCAGAGGC-TGGACCCAG---CGGATCC-CAGCAGCT-GCAGA-TC-CCAGCACAACCCGCCTCTAGTTTGGGAGCTGATACAATGTCTGCAGGCGGTGGCGGC-CCATTGGGC-GACAATAACCAAGGCGCCGACGGAGTGGGTAATGCCTCGGGAGATTGGCATTGCGATTCCACATGGATGGGCGACAGAGTCGTCACCAAGAGCACCCGAACCTGGGTCCTGCCCAGCTACAACAACCACCAGTACCGAG-AGATCAAAAGTGGCT-CAGTCGACGGA-AGCAACGCCAACGC-CTACTTCGGCTACAGCACCCCCTGGGGGTATTTTGACTTCAACAGATTCCACAGCCACTGGTCACCACGTGACTGGCAGCGACTCATCAACAACTACTGGGGATTCCGGCCCCGGTCCCTCCGGGTCAAGATCTTCAACATCCAAGTCAAGGAGGTCACG-GTGCAGGATTCCACGACGACCATCGCCAATAACCTTACCAGCACGGTTCAAGTGTTTACGGACGACG-ACTACCAGCTCCCGTACGTCGTCGGCAACG-GT-ACCGAGGGCTGCCTCCCTGCC-TTCCCGCCGCAGGTCTTCACGCTGCCGCAGTACGGCTACGCGACGCTCAACCGCGACAACACAGAAAATCC------CACTGAGCGCTCATCCTTTTTCTGCCTGGAATACTTCCCTTCGAAGATGCTGAGAACGGGCAACAACTTTGAATTCACG-TACAACTTTGAGGAAGTGCCTTTCCACAGCAGCTTCGCTCCCAGCCAGAACCTGTTCAAGCTGGCCAATCCTCTCGTGGACCAGTACCTGTACCGCTTCGTGTCGA-CT-AACAATACTGGC-GGAG-T-CCAGTTTAA-CAAGA----AC---CTGGC-G--GG--GA---GA-T-ACG--CCAACACC--TACAAAAACTGGTTCCCTGGACCCATGG-GCCGG-ACCCAG-G-GCTGGAACCTGGGC-TCTGGGGTCAACCGCGCCAGC-GTCAGTGCCTTCGCCA-CGAC-CAATAGGATGGAGCTCGA-GGGCGCGAGT-TACCAGGTGCCCC--CTCAGCCGAACGGCATGACG-AACAACCTCCAGGGCAGCAACACCTATGCCCTG-GAG-AACACTATGATTTTTAACAGCCAGCCGGCGAACCCGGGCACAACCGCAACGT-A-CCTCGAGGGGAATATGC-TCATTACCAGCGAA-AGCGAAAC-GCAGCCGGTGAACCGCGTGGCCTACAACGTCG--GCGGG-CAGATGGCAACCAACAACCAGAGCAGCACCACAG-CT-CCTGCGACCGGA-ACTTACAACCTCCA-GGAAATCGTGCCTGGCA-GCGTGTGG-ATGGAGAGAGACGTGTACCTGCAGGGTCCCATTTGGGCCAAGATTCCTGAGACGGG-GGCGCACTTTCACCCGTCTCCGGCC-ATGGGCGGCTTTGGACTGAAACACCCGCCTCCT-ATGATGCTCATCAAAAACACGCCTGTACCTGGAAATA-T-C-ACCAGCTTCAGCGACGTGCCG-GTAAGCT-CATTCATCACCCAGTACTCCACTGGACAGGTCACCGTGGAGATGGAGTGGGAGCTGAAGAAGGAAAACAGCAAGCGCTGGAATCCCGAGATCCAGTACACAAACAACTACAACGA--CCC-CCAGTTTGTGGACTTTGCTCCCGACAGCACCGGAGAATATAG-AACCACCCGCCCCATTGGCACCCGTTACCTCACCCGTCCCCTGTAA"));
        allSequences.add(new DefaultNucleotideSequence("aav6 opt", "ATGGCTGCCGATGGTTATCTTCCAGATTGGCTCGAGGACAACCTCTCTGAAGGCATTCGCGAGTGGTGGGACTTGAAACCTGGAGCC-CCGAAACCCAAAGCCAACC-AGCAAAAGCAGGACGACGGC-CGGGGTCTTGTGCTTCCTGGTTACAAGTACCTCGGACCCTTCAACGGACTCGACAAGGGGGAGCCCGTCAACGCGGCGGACGCAGCGGCCCTCGAGCACGACAAGGCCTACGACCAGCAGCTCAA-GGCGGGTGACAACCCGTACCTCCGGTACAACCACGCCGACGCCGAGTTTCAGGAGCGTCTGCAAGAAGATACGTCTTTTGGGGGCAACCTCGGGCGAGCAGTCTTCCAGGCCAAGAAGAGGGTTCTCGAACCTTTTGGTCTGGTTGAGGAAGGCGCTAAGACGGCTCCTGGAAAGAAGCGTCCGGTA-GAGCAGTCTCCACAGGAGCCAGACTCCTCCTCGGGCATCGGCAAGACAGGCCAGCAGCCCGCTAAAAAGAGACTCAATTTTGGTCAGAC-TGGCGACTCAGAGTCAGTCCCCGACCCTCAACCTCTCGGAGAACCTCCAGCA--ACCC-CCGCTGCTGTGGGACCTACTACAATGGCTTCAGGCGGTGGCG-CACCAATGG-CAGACAATAACGAAGGCGCCGACGGAGTGGGTAATGCCTCGGGAAATTGGCATTGCGATTCCACATGGCTGGGCGACAGAGTCATCACCACCAGCACCCGAACCTGGGCCCTGCCCACCTACAACAACCACCTCTAC-AAGCAAATCTCCAGT-GCTTCAA-CGGGAGCCAGCAACGACAAC-CACTACTTCGGCTACAGCACCCCCTGGGGGTATTTTGACTTCAACAGATTCCACTGCCACTTCTCACCACGTGACTGGCAGCGACTCATCAACAACAACTGGGGATTCCGGCCCAAGAGACTCAACTTCAAGCTCTTCAACATCCAAGTCAAGGAGGTCACG-ACGAATGATGGCGTCACGACCATCGCCAATAACCTTACCAGCACGGTTCAAGTGTTTTCGGACT-CGGAGTACCAGCTCCCGTACGTCCTCGGCTCTGCGC-ACC-AGGGCTGCCTCCCT-CCGTTCCCGGCGGACGTCTTCATGATTCCGCAGTACGGCTACCTGACGCTGAACAACGGCAGC-CAGGCCGTGG----------GA-CGCTCATCCTTTTACTGCCTGGAATACTTCCCTTCGCAGATGCTGAGAACGGGCAACAACTTTACCTTCA-GCTACACCTTTGAGGACGTGCCTTTCCACAGCAGCTACGCTCACAGCCAGAGCCTGGACCGGCTGATGAATCCTCTCATCGACCAGTACCTGTACTACCT-GAACAGAACTCAA-AAT-CAGTCCGGAAGTGCC--CAAAA-CAAGGACTTGCTGTTTAGCCGTGGGTCTC--CTGCTGGCATGTCTGT-TCAGCCCAAAAACTGGCTACCTGGACCC-TGTTACCGGCAGC-AGCGCGTTTCAA---AGACAAAAACAGACAACAACAACAGC-AACTTTACCTGGACTGGTGCTTCAA-AATATA-ACCTCAATGGCCGTGAATCTATCATCAATCCTGGCACTGCT--ATGGCCTCACACAAAGACGACAAAGACA--AGTTCTT-T-CCC-ATGAGCGGTGTCATGATTTTTGGCAAAGAG--AGCG--CCGGAGCT-T-C-A-AACACTG-CATTGGAC--AATGT-CATGATTACCGACGAAGAG-GAAATTAAAGCCACT-AACCCTGTGGCC-ACGGAG-AGATTTGGGACTG-TGGCAGTCAACCTCCAGAGCAGCAGCACAGAC--CCTGCGACCGGAGATGT-CCATGT-TATGGGAGCCTTACCTGGCATG-GTGTGGCA-AGACAGAGACGTGTACCTGCAGGGTCCCATTTGGGCCAAGATTCCTCACACGGATGG-ACACTTTCACCCGTCTCCG-CTGATGGGCGGCTTTGGACTGAAACACCCGCCTCCTCA-GATCCTCATCAAAAACACGCCTGTACCTGCGAATCCTCCGGCGGAGTTCAGCG-C-TACAAAGTTTGCTTCATTCATCACCCAGTACTCCACTGGACAGGTCAGCGTGGAGATTGAGTGGGAGCTGCAGAAGGAAAACAGCAAGCGCTGGAATCCCGAGGTGCAGTACACATCCAACTACG-CAAAATCTGCCAAT--GTGGACTTTACTGTGGACAACAATGGACTTTATACTGAGC-CTCGCCCCATTGGCACCCGTTACCTCACCCGTCCCCTGTAA"));
        allSequences.add(new DefaultNucleotideSequence("chimeraOpt256_4_388", "ATGGCTGCCGATGGTTATCTTCCAGATTGGCTCGAGGACAACCTCTCTGAAGGCATTCGCGAGTGGTGGGACTTGAAACCTGGAGCC-CCGAAACCCAAAGCCAACC-AGCAAAAGCAGGACGACGGC-CGGGGTCTTGTGCTTCCTGGTTACAAGTACCTCGGACCCTTCAACGGACTCGACAAGGGGGAGCCCGTCAACGCGGCGGACGCAGCGGCCCTCGAGCACGACAAGGCCTACGACCGGCAGCTCGACAGCGG-TGACAACCCGTACCTCAAGTACAACCACGCCGACGCCGAGTTTCAGGAGAAGCTGGCCGACGATACGTCTTTTGGGGGCAACCTCGGGAAGGCAGTCTTCCAGGCCAAGAAGAGGGTTCTCGAACCTTTTGGTCTGGTTGAGGAAGGCGCTAAGACGGCTCCTACCGGAAAGCGTATAG-ACGATCACTTTCCA-AAAAGAAAGAAGGCTC----GG-ACCG--AAG--AGG--A-C--TCC------AAGCC-CTCCACCTCG-TCAGACGCAGAGGC-TGGACCCAG---CGGATCC-CAGCAGCT-GCAGA-TC-CCAGCACAACCCGCCTCTAGTTTGGGAGCTGATACAATGTCTGCAGGCGGTGGCGGC-CCATTGGGC-GACAATAACCAAGGCGCCGACGGAGTGGGTAATGCCTCGGGAGATTGGCATTGCGATTCCACATGGATGGGCGACAGAGTCGTCACCAAGAGCACCCGAACCTGGGTCCTGCCCAGCTACAACAACCACCAGTACCGAG-AGATCAAAAGTGGCT-CAGTCGACGGA-AGCAACGCCAACGC-CTACTTCGGCTACAGCACCCCCTGGGGGTATTTTGACTTCAACAGATTCCACAGCCACTTCTCACCACGTGACTGGCAGCGACTCATCAACAACAACTGGGGATTCCGGCCCAAGAGACTCAACTTCAAGCTCTTCAACATCCAAGTCAAGGAGGTCACGCA-GAATGATGGCACGACGACCATCGCCAATAACCTTACCAGCACGGTTCAAGTGTTTTCGGACT-CGGAATACCAGCTCCCGTACGTCCTCGGGTCTG-GCCACA-AAGGGTGCCTTCTT-CCGTTCC-GGGGGAAGTCTTCTTGTTTCC-CAATACGG-TACCTGA-ACTGTACAACGG-AAC-CAGGCCGGGGAACTCCCACTGAGCGCTCATCCTTTTTCTGCCTGGAATACTTCCCTTCGAAGATGCTGAGAACGGGCAACAACTTTGAATTCACG-TACAACTTTGAGGAAGTGCCTTTCCACAGCAGTTTGGTTCCCAGCCAGAGCCTGGACCGGCTGATGAATCCTTTCATCGACCAGTACCTGTACTACCT-GAACAGAACT-AACACT-CCATCCGGAACCACCA-CGCAATCAAGG--TTGCAGTTTAGCCA--GGCCGGAGCGAGTGACAT-TCGGGACCAGTCTAGAAACTGGCTACCTGGACCC-TGTTACCGGCAGC-AGCGCGTTTCAA---AGACAAAAACAGACAACAACAACAGC-AACTTTACCTGGACTGGTGCTTCAA-AATATA-ACCTCAATGGCCGTGAATCTATCATCAATCCTGGCACTGCT--ATGGCCTCACACAAAGACGACGAAGAAA--AGTTCTT-T-CCCCA-GAGCGGTGTCCTCATTTTTGGCAAACAA--GGC---TCAGAGAA-AAC-A-AACGTGGATATTGAA---AAGGT-CATGATTACCGACGAAGAG-GAAATTAAAGCCACT-AACCCTGTGGCC-ACGGAG-AGATTTGGGACTG-TGGCAGTCAACCTCCAGAGCAGCAGCACAGAC--CCTGCGACCGGAGATGT-CCATGT-TATGGGAGCCTTACCTGGCATG-GTGTGG-ATGGAGAGAGACGTGTACCTGCAGGGTCCCATTTGGGCCAAGATTCCTGAGACGGG-GGCGCACTTTCACCCGTCTCCGGCC-ATGGGCGGCTTTGGACTGAAACACCCGCCTCCTCA-GATCCTCATCAAAAACACGCCTGTACCTGCGAATCCTCCGGCGGAGTTCAGCG-C-TACAAAGTTTGCTTCATTCATCACCCAGTACTCCACTGGACAGGTCAGCGTGGAGATTGAGTGGGAGCTGAAGAAGGAAAACAGCAAGCGCTGGAATCCCGAGGTGCAGTACACATCCAACTACG-CAAAATCTGCCAAT--GTGGACTTTACTGTGGACAACAATGGACTTTATACTGAGC-CTCGCCCCATTGGCACCCGTTACCTCACCCGTCCCCTGTAA"));
        ///
        crossover.CrossoverModel crossoverModel = crossover.CrossoverModel.getInstance(true, allSequences, false);
        List<SequenceDocument> parentsAsFullNucleotideSequences = crossoverModel.getParentsAsFullNucleotideSequences();
        SequenceDocument chimeraAsFullNucleotideSequence = crossoverModel.getChimeraAsFullNucleotideSequence();
        parentsAsFullNucleotideSequences.forEach(s -> assertThat(s.getCharSequence().length(), is(crossoverModel.getChimera().length())));
        postToUM(parentsAsFullNucleotideSequences, chimeraAsFullNucleotideSequence);
        crossoverModel.calculateStatisticsIfNotAlreadyIn();
        //
        assertThat("Crossover discounting mutations", crossoverModel.getCrossoverDiscountingMutation(), is(16));
        //assertThat("Crossover considering mutations", crossoverModel.getCrossoverConsideringMutations(), is(17));
        assertThat("Mutations", crossoverModel.getPointMutations(), is(26L));
        assertThat("Lev", crossoverModel.getLevenshteinDistances().get(0), is(293));
        assertThat("Lev", crossoverModel.getLevenshteinDistances().get(1), is(419));
        assertThat("Lev", crossoverModel.getLevenshteinDistances().get(2), is(263));
        ArrayList<Integer> fragments = crossoverModel.getUniqueLengthsUngappedFragments();
//        assertThat("Fragments", crossoverModel.getUniqueLengthsUngappedFragments(), is(Stream.of(3, 191, 164, 27, 882, 862, 43).collect(Collectors.toList())));
//        double meanSizeOfFrag = fragments.stream().mapToInt(i -> i).average().getAsDouble();
//        assertThat("Mean Size", meanSizeOfFrag, is(equalTo(310.2857142857143)));
    }

    @Test //matches
    public void testCrossoverStatisticsForChimeraOpt256_2_388() throws Exception { // I removed some chars from the beginning of 10 TODO I don't know if this matches with anything ans UofM seems to have a different alignment
        ArrayList<SequenceDocument> allSequences = new ArrayList<>();
        allSequences.add(new DefaultNucleotideSequence("aav2 opt", "ATGGCTGCCGATGGTTATCTTCCAGATTGGCTCGAGGACACTCTCTCTGAAGGCATTCGCCAGTGGTGGAAGTTGAAACCTGGA-CCACCGCCACCCAAACCCG-CAGAGCGGCATAAGGACGACAGC-CGGGGTCTTGTGCTTCCTGGTTACAAGTACCTCGGACCCTTCAACGGACTCGACAAGGGGGAGCCCGTCAACGAGGCGGACGCAGCGGCCCTCGAGCACGACAAGGCCTACGACCGGCAGCTCGACAGCGG-TGACAACCCGTACCTCAAGTACAACCACGCCGACGCCGAGTTTCAGGAGCGTCTGAAAGAAGATACGTCTTTTGGGGGCAACCTCGGGCGAGCAGTCTTCCAGGCCAAGAAGAGGGTTCTCGAACCTCTTGGTCTGGTTGAGGAACCTGTTAAGACGGCTCCTGGAAAGAAGCGTCCGGTA-GAGCACTCTCCAGTGGAGCCAGACTCCTCCTCGGGCACCGGCAAGGCGGGCCAGCAGCCCGCTAGAAAGAGACTCAATTTTGGTCAGAC-TGGCGACGCAGACTCAGTCCCCGACCCTCAACCTCTCGGACAGCCTCCAGCA--GCCC-CCTCTGGTTTGGGAACTAATACAATGGCTACAGGCAGTGGCG-CACCAATGG-CAGACAATAACGAAGGCGCCGACGGAGTGGGTAATTCCTCGGGAAATTGGCATTGCGATTCCACATGGATGGGCGACAGAGTCATCACCACCAGCACCCGAACCTGGGCCCTGCCCACCTACAACAACCACCTCTAC-AAGCAAATC---AGTAGC--CAATCAGGAGCCAGCAACGACAAC-CACTACTTCGGCTACAGCACCCCCTGGGGGTATTTTGACTTCAACAGATTCCACTGCCACTTCTCACCACGTGACTGGCAGCGACTCATCAACAACAACTGGGGATTCCGGCCCAAGAGACTCAACTTCAAGCTCTTCAACATCCAAGTCAAGGAGGTCACGCA-GAATGATGGCACGACGACCATCGCCAATAACCTTACCAGCACGGTTCAAGTGTTTACGGACT-CGGAGTACCAGCTCCCGTACGTCCTCGGCTCTGCGCACC-AGGGCTGCCTCCCT-CCGTTCCCGGCGGACGTCTTCATGGTGCCGCAGTACGGCTACCTGACGCTGAACAACGGCAGC-CAGG-----CCG-TGGGACGCTCATCCTTTTACTGCCTGGAATACTTCCCTTCGCAGATGCTGAGAACGGGCAACAACTTTACCTTCAGC-TACACCTTTGAGGACGTGCCTTTCCACAGCAGCTACGCTCACAGCCAGAGCCTGGACCGGCTGATGAATCCTCTCATCGACCAGTACCTGTACTACCT-GAGCAGAACT-AACACT-CCATCCGGAACCACCA-CGCAATCAAGG--TTGCAGTTTAGCCA--GGCCGGAGCGAGTGACAT-TCGGGACCAGTCTAGAAACTGGCTACCTGGACCC-TGTTACCGG-CAGCAGCGCGTTTCAA---AGACATCTGCGGACAACAACAACAGCG--AATAC-T-CGTGGACTGGTGCTACCAAATATCATCTCAATGGCCGTGACTCTCT-GGTGAATCCT-GGCCCGGCTATGGCCTCACACAAAGACGACGAAGAAA--AGTTCTT-T-CCCCA-GAGCGGTGTCCTCATTTTTGGCAAACAA--GGC---TCAGAGAAAACAAACGTGG-ATAT-T---GAA-AAGGT-CATGATTACCGACGAAGAG-GAAATTAGGACCACT-AACCCTGTGGCC-ACGGAGCAG-TATGGGTCTG-TGTCTACCAACCTCCAGAGAGGCA--ACAGACAAGCAGCGACCGCAGATGT-CAACACACA-GGGAGTTTTACCTGGCATG-GTGTGGCA-AGACAGAGACGTGTACCTGCAGGGTCCCATTTGGGCCAAGATTCCTCACACGGATGG-ACACTTTCACCCGTCTCCG-CTGATGGGCGGCTTTGGACTGAAACACCCGCCTCCTCA-GATCCTCATCAAAAACACGCCTGTACCTGCGAATCCTTCGACCACCTTCAGCG-C-TGCAAAGTTTGCTTCATTCATCACCCAGTACTCCACTGGACAGGTCAGCGTGGAGATTGAGTGGGAGCTGCAGAAGGAAAACAGCAAGCGCTGGAATCCCGAGATCCAGTACACATCCAACTACAACAAA-TCT-GTTAATGTGGACTTTACTGTGGACACTAATGGAGTGTATAGTGAGC-CTCGCCCCATTGGCACCCGTTACCTCACCCGTAATCTGTAA"));
        allSequences.add(new DefaultNucleotideSequence("aav5 opt", "ATGTCTTTTGTTGATCACCCTCCAGATTGGCTCGAGGA-AGT-TGG-TGAAGGCCTTCGCGAGTTTTTGGGCTTGGAAGCGGGA-CCACCGAAACCCAAACCCAACC-AGCAACATCAGGACCA-AGCTCGGGGTCTTGTGCTTCCTGGTTACAACTACCTCGGACCCGGCAACGGACTCGACCGAGGGGAGCCCGTCAACAGGGCGGACGAGGTCGCCCGAGAGCACGACATCTCGTACAACGAGCAGCTCGA-GGCGGGTGACAACCCGTACCTCAAGTACAACCACGCCGACGCCGAGTTTCAGGAGAAGCTGGCCGACGATACGTCTTTTGGGGGCAACCTCGGGAAGGCAGTCTTCCAGGCCAAGAAGAGGGTTCTCGAACCTTTTGGTCTGGTTGAGGAAGGCGCTAAGACGGCTCCTACCGGAAAGCGTATAG-ACGATCACTTTCCA-AAAAGAAAGAAGGCT---CGG--ACCG--AAGA--GG--A----CTC-C----AAGCC-CTCCACCTCG-TCAGACGCAGAGGC-TGGACCCAG---CGGATCC-CAGCAGCT-GCAGA-TC-CCAGCACAACCCGCCTCTAGTTTGGGAGCTGATACAATGTCTGCAGGCGGTGGCGGC-CCATTGGGC-GACAATAACCAAGGCGCCGACGGAGTGGGTAATGCCTCGGGAGATTGGCATTGCGATTCCACATGGATGGGCGACAGAGTCGTCACCAAGAGCACCCGAACCTGGGTCCTGCCCAGCTACAACAACCACCAGTACCGAG-AGATCAAAAGTGGCT-CAGTCGACGGA-AGCAACGCCAACGC-CTACTTCGGCTACAGCACCCCCTGGGGGTATTTTGACTTCAACAGATTCCACAGCCACTGGTCACCACGTGACTGGCAGCGACTCATCAACAACTACTGGGGATTCCGGCCCCGGTCCCTCCGGGTCAAGATCTTCAACATCCAAGTCAAGGAGGTCACG-GTGCAGGATTCCACGACGACCATCGCCAATAACCTTACCAGCACGGTTCAAGTGTTTACGGACGACG-ACTACCAGCTCCCGTACGTCGTCGGCAACG-GTACCGAGGGCTGCCTCCCTGCC-TTCCCGCCGCAGGTCTTCACGCTGCCGCAGTACGGCTACGCGACGCTCAACCGCGACAACACAGAAAATCCCACTGAG-CGCTCATCCTTTTTCTGCCTGGAATACTTCCCTTCGAAGATGCTGAGAACGGGCAACAACTTTGAATTCA-CGTACAACTTTGAGGAAGTGCCTTTCCACAGCAGCTTCGCTCCCAGCCAGAACCTGTTCAAGCTGGCCAATCCTCTCGTGGACCAGTACCTGTACCGCTTCGTGTCGA-CT-AACAATACTGGC-GGA-GT-CCAGTTTAA-CAAGAACCTG--GC--GGG-G-AGAT--A--C-GCCAACAC--C----T-A--C-AAAAACTGGTTCCCTGGACCCATGG-GCCGGACC-CAG-G-GCTGGAACCTGGGC-TCTGGGGTCAACCGCGCCAGCGTCAGTGCCTTCGCC-AC-GAC-CAATAGGATG-GAGCTCGAGGGC-GCGAGTTACCAGGTGCCCCCTCAGC-CGA--ACGGCATGACG-AACAACCTCCAGGGCAGCAACACCTATGCCCTG-GAG-AACACTATGATTTTTAACAGCCAGCCGGCGAACCCGGGCA--CAACCGCAACGTACCTCGAGGGGAATATGC-TCATTACCAGCGAA-AGCGAAAC-GCAGCCGGTGAACCGCGTGGCCTACAACGTCG--GCGGG-CAGATGGCAACCAACAACCAGAGCAGCACCACAG-CT-CCTGCGACCGGA-ACTTACAACCTCCA-GGAAATCGTGCCTGGCA-GCGTGTGG-ATGGAGAGAGACGTGTACCTGCAGGGTCCCATTTGGGCCAAGATTCCTGAGACGGG-GGCGCACTTTCACCCGTCTCCGGCC-ATGGGCGGCTTTGGACTGAAACACCCGCCTCCT-ATGATGCTCATCAAAAACACGCCTGTACCTG-GAAATAT-C-ACCAGCTTCAGCGACGTGCCG-GTAAGCT-CATTCATCACCCAGTACTCCACTGGACAGGTCACCGTGGAGATGGAGTGGGAGCTGAAGAAGGAAAACAGCAAGCGCTGGAATCCCGAGATCCAGTACACAAACAACTACAACGACCCCCAGTT--TGTGGACTTTGCTCCCGACAGCACCGGAGAATATAG-AACCACCCGCCCCATTGGCACCCGTTACCTCACCCGTCCCCTGTAA"));
        allSequences.add(new DefaultNucleotideSequence("aav6 opt", "ATGGCTGCCGATGGTTATCTTCCAGATTGGCTCGAGGACAACCTCTCTGAAGGCATTCGCGAGTGGTGGGACTTGAAACCTGGAGCC-CCGAAACCCAAAGCCAACC-AGCAAAAGCAGGACGACGGC-CGGGGTCTTGTGCTTCCTGGTTACAAGTACCTCGGACCCTTCAACGGACTCGACAAGGGGGAGCCCGTCAACGCGGCGGACGCAGCGGCCCTCGAGCACGACAAGGCCTACGACCAGCAGCTCAA-GGCGGGTGACAACCCGTACCTCCGGTACAACCACGCCGACGCCGAGTTTCAGGAGCGTCTGCAAGAAGATACGTCTTTTGGGGGCAACCTCGGGCGAGCAGTCTTCCAGGCCAAGAAGAGGGTTCTCGAACCTTTTGGTCTGGTTGAGGAAGGCGCTAAGACGGCTCCTGGAAAGAAGCGTCCGGTA-GAGCAGTCTCCACAGGAGCCAGACTCCTCCTCGGGCATCGGCAAGACAGGCCAGCAGCCCGCTAAAAAGAGACTCAATTTTGGTCAGAC-TGGCGACTCAGAGTCAGTCCCCGACCCTCAACCTCTCGGAGAACCTCCAGCA--ACCC-CCGCTGCTGTGGGACCTACTACAATGGCTTCAGGCGGTGGCG-CACCAATGG-CAGACAATAACGAAGGCGCCGACGGAGTGGGTAATGCCTCGGGAAATTGGCATTGCGATTCCACATGGCTGGGCGACAGAGTCATCACCACCAGCACCCGAACCTGGGCCCTGCCCACCTACAACAACCACCTCTAC-AAGCAAATCTCCAGT-GCTTCAA-CGGGAGCCAGCAACGACAAC-CACTACTTCGGCTACAGCACCCCCTGGGGGTATTTTGACTTCAACAGATTCCACTGCCACTTCTCACCACGTGACTGGCAGCGACTCATCAACAACAACTGGGGATTCCGGCCCAAGAGACTCAACTTCAAGCTCTTCAACATCCAAGTCAAGGAGGTCACG-ACGAATGATGGCGTCACGACCATCGCCAATAACCTTACCAGCACGGTTCAAGTGTTTTCGGACT-CGGAGTACCAGCTCCCGTACGTCCTCGGCTCTGCGCACC-AGGGCTGCCTCCCT-CCGTTCCCGGCGGACGTCTTCATGATTCCGCAGTACGGCTACCTGACGCTGAACAACGGCAGC-CAGG-----CCG-TGGGACGCTCATCCTTTTACTGCCTGGAATACTTCCCTTCGCAGATGCTGAGAACGGGCAACAACTTTACCTTCAGC-TACACCTTTGAGGACGTGCCTTTCCACAGCAGCTACGCTCACAGCCAGAGCCTGGACCGGCTGATGAATCCTCTCATCGACCAGTACCTGTACTACCT-GAACAGAACTCAA-AAT-CAGTCCGGAAGTGCC--CAAAA-CAAGGACTTGCTGTTTAGCCGTGGGTCTC--CTGCTGGCATGTCTGT-TCAGCCCAAAAACTGGCTACCTGGACCC-TGTTACCGG-CAGCAGCGCGTTTCAA---AGACAAAAACAGACAACAACAACAGC---AACTT-TACCTGGACTGGTGCTTCAAAATATAACCTCAATGGCCGTGAATCTAT-CATCAATCCT-GGCACTGCTATGGCCTCACACAAAGACGACAAAGACA--AGTTCTT-T-CCC-ATGAGCGGTGTCATGATTTTTGGCAAAGAG--AGCG--CCGGAGCTT-CAAACACTG--CAT-T---GGACAATGT-CATGATTACCGACGAAGAG-GAAATTAAAGCCACT-AACCCTGTGGCC-ACGGAG-AGATTTGGGACTG-TGGCAGTCAACCTCCAGAGCAGCAGCACAGAC--CCTGCGACCGGAGATGT-CCATGT-TATGGGAGCCTTACCTGGCATG-GTGTGGCA-AGACAGAGACGTGTACCTGCAGGGTCCCATTTGGGCCAAGATTCCTCACACGGATGG-ACACTTTCACCCGTCTCCG-CTGATGGGCGGCTTTGGACTGAAACACCCGCCTCCTCA-GATCCTCATCAAAAACACGCCTGTACCTGCGAATCCTCCGGCGGAGTTCAGCG-C-TACAAAGTTTGCTTCATTCATCACCCAGTACTCCACTGGACAGGTCAGCGTGGAGATTGAGTGGGAGCTGCAGAAGGAAAACAGCAAGCGCTGGAATCCCGAGGTGCAGTACACATCCAACTACG-CAAAATCT-GCCAATGTGGACTTTACTGTGGACAACAATGGACTTTATACTGAGC-CTCGCCCCATTGGCACCCGTTACCTCACCCGTCCCCTGTAA"));
        allSequences.add(new DefaultNucleotideSequence("Opt256_2_388", "ATGGCTGCCGATGGTTATCTTCCAGATTGGCTCGAGGACAACCTCTCTGAAGGCATTCGCGAGTGGTGGGACTTGAAACCTGGA-CCACCGCCACCCAAACCCG-CAGAGCGGCATAAGGACGACGGC-CGGGGTCTTGTGCTTCCTGGTTACAAGTACCTCGGACCCTTCAACGGACTCGACAAGGGGGAGCCCGTCAACGAGGCGGACGCAGCGGCCCTCGAGCACGACATCTCGTACAACGAGCAGCTCGA-GGCGGGTGACAACCCGTACCTCAAGTACAACCACGCCGACGCCGAGTTTCAGGAGAAGCTGGCCGACGATACGTCTTTTGGGGGCAACCTCGGGAAGGCAGTCTTCCAGGCCAAGAAGAGGGTTCTCGAACCTTTTGGTCTGGTTGAGGAACCTGTTAAGACGGCTCCTGGAAAGAAGCGTCCGGTA-GAGCAGTCTCCACAGGAGCCAGACTCCTCCTCGGGCATCGGCAAGACAGGCCAGCAGCCCGCTAAAAAGAGACTCAATTTTGGTCAGAC-TGGCGACGCAGACTCAGTCCCCGACCCTCAACCTCTCGGACAGCCTCCAGCA--GCCC-CCTCTGGTTTGGGAACTAATACAATGGCTTCAGGCGGTGGCG-CACCAATGG-CAGACAATAACGAAGGCGCCGACGGAGTGGGTAATTCCTCGGGAAATTGGCATTGCGATTCCACATGGATGGGCGACAGAGTCGTCACCAAGAGCACCCGAACCTGGGTCCTGCCCAGCTACAACAACCACCTCTAC-AAGCAAATCTCCAGT-GCTTCAA-CGGGAGCCAGCAACGACAAC-CACTACTTCGGCTACAGCACCCCCTGGGGGTATTTTGACTTCAACAGATTCCACTGCCACTTCTCACCACGTGACTGGCAGCGACTCATCAACAACAACTGGGGATTCCGGCCCAAGAGACTCAACTTCAAGCTCTTCAACATCCAAGTCAAGGAGGTCACGCA-GAATGATGGCACGACGACCATCGCCAATAACCTTACCAGCACGGTTCAAGTGTTTACGGACT-CGGAGTACCAGCTCCCGTACGTCGTCGGCAACG-GTACCGAGGGCTGCCTCCCTGCC-TTCCCGCCGCAGGTCTTCACGCTGCCGCAGTACGGCTACGCGACGCTCAACCGCGACAACACAGAAAATCCCACTGAG-CGCTCATCCTTTTTCTGCCTGGAATACTTCCCTTCGCAGATGCTGAGAACGGGCAACAACTTTACCTTCAGC-TACACCTTTGAGGACGTGCCTTTCCACAGCAGCTACGCTCACAGCCAGAGCCTGGACCGGCTGATGAATCCTCTCATCGACCAGTACCTGTACTACCT-GAACAGAACTCAA-AAT-CAGTCCGGAAGTGCC--CAAAA-CAAGGACTTGCTGTTTAGCCGTGGGTCTC--CTGCTGGCATGTCTGT-TCAGCCCAAAAACTGGCTACCTGGACCC-TGTTACCGG-CAGCAGCGCGTTTCAA---AGACAAAAACAGACAACAACAACAGCG--AATAC-T-CGTGGACTGGTGCTACCAAATATCATCTCAATGGCCGTGACTCTCT-GGTGAATCCT-GGCCCGGCTATGGCCTCACACAAAGACGACGAAGAAA--AGTTCTT-T-CCC-ATGAGCGGTGTCATGATTTTTGGCAAAGAG--AGCG--CCGGAGCTT-CAAACACTG--CAT-T---GGACAATGT-CATGATTACCGACGAAGAG-GAAATTAAAGCCACT-AACCCTGTGGCC-ACGGAG-AGATTTGGGACTG-TGGCAGTCAACCTCCAGAGCAGCAGCACAGAC--CCTGCGACCGGAGATGT-CCATGT-TATGGGAGCCTTACCTGGCATG-GTGTGGCA-AGACAGAGACGTGTACCTGCAGGGTCCCATTTGGGCCAAGATTCCTCACACGGATGG-ACACTTTCACCCGTCTCCG-CTGATGGGCGGCTTTGGACTGAAACACCCGCCTCCTCA-GATCCTCATCAAAAACACGCCTGTACCTG-GAAATAT-C-ACCAGCTTCAGCGACGTGCCG-GTAAGCT-CATTCATCACCCAGTACTCCACTGGACAGGTCACCGTGGAGATGGAGTGGGAGCTGAAGAAGGAAAACAGCAAGCGCTGGAATCCCGAGATCCAGTACACAAACAACTACAACGACCCCCAGTT--TGTGGACTTTGCTCCCGACAGCACCGGAGAATATAG-AACCACCCGCCCCATTGGCACCCGTTACCTCACCCGTCCCCTGTAA"));
        ///
        crossover.CrossoverModel crossoverModel = crossover.CrossoverModel.getInstance(true, allSequences, false);
        List<SequenceDocument> parentsAsFullNucleotideSequences = crossoverModel.getParentsAsFullNucleotideSequences();
        SequenceDocument chimeraAsFullNucleotideSequence = crossoverModel.getChimeraAsFullNucleotideSequence();
        parentsAsFullNucleotideSequences.forEach(s -> assertThat(s.getCharSequence().length(), is(crossoverModel.getChimera().length())));
        postToUM(parentsAsFullNucleotideSequences, chimeraAsFullNucleotideSequence);
        crossoverModel.calculateStatisticsIfNotAlreadyIn();
        //
        assertThat("Crossover discounting mutations", crossoverModel.getCrossoverDiscountingMutation(), is(17));//matches UofM
        //assertThat("Crossover considering mutations", crossoverModel.getCrossoverConsideringMutations(), is(17));//todo check manually. It's probably wrong because there are 0 mutations
        assertThat("Mutations", crossoverModel.getPointMutations(), is(0L));//UofM has 5 mutations due to incorrect alignment
        assertThat("Lev", crossoverModel.getLevenshteinDistances().get(0), is(217));//UofM 176
        assertThat("Lev", crossoverModel.getLevenshteinDistances().get(1), is(450));//UofM 576
        assertThat("Lev", crossoverModel.getLevenshteinDistances().get(2), is(166)); //UofM 189
        ArrayList<Integer> fragments = crossoverModel.getUniqueLengthsUngappedFragments();
//        assertThat("Fragments", crossoverModel.getUniqueLengthsUngappedFragments(), is(Stream.of(3, 191, 164, 27, 882, 862, 43).collect(Collectors.toList())));
//        double meanSizeOfFrag = fragments.stream().mapToInt(i -> i).average().getAsDouble();
//        assertThat("Mean Size", meanSizeOfFrag, is(equalTo(310.2857142857143)));
    }

    @Test
    public void TestUofMLevData() {
        //this is what I got in the produced xsl file. This include Gaps of course
        String chiString = "ATGGCTGCCGATGGTTATCTTCCAGATTGGCTCGAGGACAACCTCTCTGAGGGCATTCGCGAGTGGTGGGACTTGAAACCTGGAGCCCCGAAACCCAAAGCCAACCAGCAAAAGCAGGACGACGGCCGGGGTCTGGTGCTTCCTGGCTACAAGTACCTCGGACCCTTCAACGGACTCGACAAGGGGGAGCCCGTCAACGCGGCGGATGCAGCGGCCCTCGAGCACGACAAGGCCTACGACCAGCAGCTCAAAGCGGGTGACAATCCGTACCTGCGGTATAACCACGCCGACGCCGAGTTTCAGGAGCGTCTGCAAGAAGATACGTCTTTTGGGGGCAACCTCGGGCGAGCAGTCTTCCAGGCGAAAAAGAGGGTTCTTGAACCTCTGGGCCTGGTTGAGGAACCTGTTAAGACGGCTCCGGGAAAAAAGAGGCCGGTAGAGCACTCTCCTGTGGAGCCAGACTCCTCCTCGGGAACCGGAAAGGCGGGCCAGCAGCCCGCTAAAAAGAGACTCAATTTTGGTCAGACTGGCGACTCAGAGTCAGTCCCCGACCCACAACCTCTCGGAGAACCTCCAGCAACCCCCGCTGCTGTGGGACCTACTACAATGGCTTCAGGCGGTGGCGCACCAATGGCAGACAATAACGAAGGCGCCGACGGAGTGGGTAATGCCTCGGGAGATTGGCATTGCGATTCCACGTGGATGGGGGACAGAGTCATCACCACCAGCACCCGAACCTGGGCCCTGCCCACCTATAACAACCACCTCTACAAGCAAATCTCCAGTGCTTCAACGGGGGCCAGCAACGACAACCACTACTTCGGCTACAGCACCCCCTGGGGGTATTTTGATTTCAACAGATTCCACTGCCATTTCTCACCACGTGACTGGCAGCGACTCATCAACAACAACTGGGGATTCCGACCCAAGAGACTCAACTTCAAGCTCTTCAACATCCAAGTCAAGGAGGTCACGACGAATGATGGCGTCACGACCATCGCTAATAACCTTACCAGCACGGTTCAGGTGTTTACTGACTCGGAGTACCAGCTCCCGTACGTCCTCGGCTCTGCGCACCAGGGCTGCCTCCCTCCGTTCCCGGCGGACGTGTTCATGATTCCGCAGTACGGCTACCTAACGCTCAACAATGGCAGCCAG------GCAGTGGGACGGTCATCCTTTTACTGCCTGGAATATTTCCCATCGCAGATGCTGAGAACGGGCAATAACTTTACCTTCAGCTACACCTTCGAGGACGTGCCTTTCCACAGCAGCTACGCGCACAGCCAGAGCCTGGACCGGCTGATGAATCCTCTCATCGACCAGTACCTGTATTACCTGAACAGAACTCAGAATCAGTCCGGAAGTGCCCAAAACAAGGACTTGCTGTTTAGCCGGGGGTCTCCAGCTGGCATGTCTGTTCAGCCCAAAAACTGGCTACCTGGACCCTGTTACCGGCAGCAGCGCGTTTCTAAAACAAAAACAGACAACAACAACAGCAACTTTACCTGGACTGGTGCTTCAAAATATAACCTTAATGGGCGTGAATCTATAATCAACCCTGGCACTGCTATGGCCTCACACAAAGACGACAAAGACAAGTTCTTTCCCATGAGCGGTGTCATGATTTTTGGAAAGGAG------AGCGCCGGAGCTTCAAACACTGCATT---GGACAATGTCATGATCACAGACGAAGAGGAAATCAAAGCCACTAACCCCGTGGCCACCGAAAGATTTGGGACTGTGGCAGTCAATCTCCAGAGCAGCAGCACAGACCCTGCGACCGGAGATGTGCATGTTATGGGAGCCTTACCTGGAATGGTGTGGCAAGACAGAGACGTATACCTGCAGGGTCCTATTTGGGCCAAAATTCCTCACACGGATGGACACTTTCACCCGTCTCCTCTCATGGGCGGCTTTGGACTTAAGCACCCGCCTCCTCAGATCCTCATCAAAAACACGCCTGTTCCTGCGAATCCTCCGGCAGAGTTTTCGGCTACAAAGTTTGCTTCATTCATCACCCAGTATTCCACAGGACAAGTGAGCGTGGAGATTGAATGGGAGCTGCAGAAAGAAAACAGCAAACGCTGGAATCCCGAAGTGCAGTATACATCTAACTATGCAAAATCTGCCAACGTTGATTTCACTGTGGACAACAATGGACTTTATACTGAGCCTCGCCCCATTGGCACCCGTTACCTCACCCGTCCCCTGTAA";
        String wt2String = "ATGGCTGCCGATGGTTATCTTCCAGATTGGCTCGAGGACACTCTCTCTGAAGGAATAAGACAGTGGTGGAAGCTCAAACCTGGCCCACCACCACCAAAGCCCGCAGAGCGGCATAAGGACGACAGCAGGGGTCTTGTGCTTCCTGGGTACAAGTACCTCGGACCCTTCAACGGACTCGACAAGGGAGAGCCGGTCAACGAGGCAGACGCCGCGGCCCTCGAGCACGACAAAGCCTACGACCGGCAGCTCGACAGCGGAGACAACCCGTACCTCAAGTACAACCACGCCGACGCGGAGTTTCAGGAGCGCCTTAAAGAAGATACGTCTTTTGGGGGCAACCTCGGACGAGCAGTCTTCCAGGCGAAAAAGAGGGTTCTTGAACCTCTGGGCCTGGTTGAGGAACCTGTTAAGACGGCTCCGGGAAAAAAGAGGCCGGTAGAGCACTCTCCTGTGGAGCCAGACTCCTCCTCGGGAACCGGAAAGGCGGGCCAGCAGCCTGCAAGAAAAAGATTGAATTTTGGTCAGACTGGAGACGCAGACTCAGTACCTGACCCCCAGCCTCTCGGACAGCCACCAGCAGCCCCCTCTGGTCTGGGAACTAATACGATGGCTACAGGCAGTGGCGCACCAATGGCAGACAATAACGAGGGCGCCGACGGAGTGGGTAATTCCTCGGGAAATTGGCATTGCGATTCCACATGGATGGGCGACAGAGTCATCACCACCAGCACCCGAACCTGGGCCCTGCCCACCTACAACAACCACCTCTACAAACAAATTTCCAGCCAATCAG---GAGCCTCGAACGACAATCACTACTTTGGCTACAGCACCCCTTGGGGGTATTTTGACTTCAACAGATTCCACTGCCACTTTTCACCACGTGACTGGCAAAGACTCATCAACAACAACTGGGGATTCCGACCCAAGAGACTCAACTTCAAGCTCTTTAACATTCAAGTCAAAGAGGTCACGCAGAATGACGGTACGACGACGATTGCCAATAACCTTACCAGCACGGTTCAGGTGTTTACTGACTCGGAGTACCAGCTCCCGTACGTCCTCGGCTCGGCGCATCAAGGATGCCTCCCGCCGTTCCCAGCAGACGTCTTCATGGTGCCACAGTATGGATACCTCACCCTGAACAACGGGAGTCAG------GCAGTAGGACGCTCTTCATTTTACTGCCTGGAGTACTTTCCTTCTCAGATGCTGCGTACCGGAAACAACTTTACCTTCAGCTACACTTTTGAGGACGTTCCTTTCCACAGCAGCTACGCTCACAGCCAGAGTCTGGACCGTCTCATGAATCCTCTCATCGACCAGTACCTGTATTACTTGAGCAGAACAAACACTCCAAGTGGAACCACCACGCAGTCAAGGCTTCAGTTTTCTCAGGCCGGAGCGAGTGACATTCGGGACCAGTCTAGGAACTGGCTTCCTGGACCCTGTTACCGCCAGCAGCGAGTATCAAAGACATCTGCGGATAACAACAACAGTGAATACTCGTGGACTGGAGCTACCAAGTACCACCTCAATGGCAGAGACTCTCTGGTGAATCCGGGCCCGGCCATGGCAAGCCACAAGGACGATGAAGAAAAGTTTTTTCCTCAGAGCGGGGTTCTCATCTTTGGGAAGCAA------GGCTCAGAGAAAACAAATGTGGACAT---TGAAAAGGTCATGATTACAGACGAAGAGGAAATCAGGACAACCAATCCCGTGGCTACGGAGCAGTATGGTTCTGTATCTACCAACCTCCAGAGAGGCAACAGACAAGCAGCTACCGCAGATGTCAACACACAAGGCGTTCTTCCAGGCATGGTCTGGCAGGACAGAGATGTGTACCTTCAGGGGCCCATCTGGGCAAAGATTCCACACACGGACGGACATTTTCACCCCTCTCCCCTCATGGGTGGATTCGGACTTAAACACCCTCCTCCACAGATTCTCATCAAGAACACCCCGGTACCTGCGAATCCTTCGACCACCTTCAGTGCGGCAAAGTTTGCTTCCTTCATCACACAGTACTCCACGGGACAGGTCAGCGTGGAGATCGAGTGGGAGCTGCAGAAGGAAAACAGCAAACGCTGGAATCCCGAAATTCAGTACACTTCCAACTACAACAAGTCTGTTAATGTGGACTTTACTGTGGACACTAATGGCGTGTATTCAGAGCCTCGCCCCATTGGCACCAGATACCTGACTCGTAATCTGTAA";
        String wt5String = "ATGTCTTTTGTTGATCACCCTCCAGATTGGTT---GGAAGAAGTTGGTGAAGGTCTTCGCGAGTTTTTGGGCCTTGAAGCGGGCCCACCGAAACCAAAACCCAATCAGCAGCATCAAGATCAAGCCCGTGGTCTTGTGCTGCCTGGTTATAACTATCTCGGACCCGGAAACGGTCTCGATCGAGGAGAGCCTGTCAACAGGGCAGACGAGGTCGCGCGAGAGCACGACATCTCGTACAACGAGCAGCTTGAGGCGGGAGACAACCCCTACCTCAAGTACAACCACGCGGACGCCGAGTTTCAGGAGAAGCTCGCCGACGACACATCCTTCGGGGGAAACCTCGGAAAGGCAGTCTTTCAGGCCAAGAAAAGGGTTCTCGAACCTTTTGGCCTGGTTGAAGAGGGTGCTAAGACGGCCCCTACCGGAAAGCGGATAGACGACCACTTTCCAAAAAGAAAGAAGGCTCGGACC-GAAGAGGACTCCA----------------------AGCCTTCCACCTCGTCA----GACGCCGAAGCTGGACCCAGCGGATCCCAGCAGCTGCAAATCCCAGCCCAACCAGCCTCAAGTTTGGGAGCTGATACAATGTCTGCGGGAGGTGGCGGCCCATTGGGCGACAATAACCAAGGTGCCGATGGAGTGGGCAATGCCTCGGGAGATTGGCATTGCGATTCCACGTGGATGGGGGACAGAGTCGTCACCAAGTCCACCCGAACCTGGGTGCTGCCCAGCTACAACAACCACCAGTACCGAGAGATCAAAAGCGGCTCCGTCGACGGAAGCAACGCCAACGCCTACTTTGGATACAGCACCCCCTGGGGGTACTTTGACTTTAACCGCTTCCACAGCCACTGGAGCCCCCGAGACTGGCAAAGACTCATCAACAACTACTGGGGCTTCAGACCCCGGTCCCTCAGAGTCAAAATCTTCAACATTCAAGTCAAAGAGGTCACGGTGCAGGACTCCACCACCACCATCGCCAACAACCTCACCTCCACCGTCCAAGTGTTTACGGACGACGACTACCAGCTGCCCTACGTCGTCGGCAACGGGACCGAGGGATGCCTGCCGGCCTTCCCTCCGCAGGTCTTTACGCTGCCGCAGTACGGTTACGCGACGCTGAACCGCGACAACACAGAAAATCCCACCGAGAGGAGCAGCTTCTTCTGCCTAGAGTACTTTCCCAGCAAGATGCTGAGAACGGGCAACAACTTTGAGTTTACCTACAACTTTGAGGAGGTGCCCTTCCACTCCAGCTTCGCTCCCAGTCAGAACCTGTTCAAGCTGGCCAACCCGCTGGTGGACCAGTACTTGTACCGCTTCGTGAGCACAAATAACACTGGCGGAGTCCAGTTCAACAAGAACCTGGCCGGGAGATACGCCAACA------------------CCTACAAAAACTGGTTCCCGGGGCCCATGGGCCGAACCCAGGGCTGGAACCTGGGCTCCGGGGTCAACCGCGCCAGTGTCAGCGCCTTCGCCACGACCAATAGGATGGAGCTCGAGGGCGCGAGTTACCAGGTGCCCCCGCAGCCGAACGGCATGACCAACAACCTCCAGGGCAGCAACACCTATGCCCTGGAGAACACTATGATCTTCAACAGCCAGCCGGCGAACCCGGGCACCACCGCCACGTACCTCGAGGGCAACATGCTCATCACCAGCGAGAGCGAGACGCAGCCGGTGAACCGCGTGGCGTACAACGTCGGCGGGCAGATGGCCACCAACAACCAGAGCTCCACCACTGCCCCCGCGACCGGCACGTACAACCTCCAGGAAATCGTGCCCGGCAGCGTGTGGATGGAGAGGGACGTGTACCTCCAAGGACCCATCTGGGCCAAGATCCCAGAGACGGGGGCGCACTTTCACCCCTCTCCGGCCATGGGCGGATTCGGACTCAAACACCCACCGCCCATGATGCTCATCAAGAACACGCCTGTGCCCGGAAATATCACCAG---CTTCTCGGACGTGCCCGTCAGCAGCTTCATCACCCAGTACAGCACCGGGCAGGTCACCGTGGAGATGGAGTGGGAGCTCAAGAAGGAAAACTCCAAGAGGTGGAACCCAGAGATCCAGTACACAAACAACTACAACGACCCCCAGTTTGTGGACTTTGCCCCGGACAGCACCGGGGAATACAGAACCACCAGACCTATCGGAACCCGATACCTTACCCGACCCCTTTAA";
        String wt6String = "ATGGCTGCCGATGGTTATCTTCCAGATTGGCTCGAGGACAACCTCTCTGAGGGCATTCGCGAGTGGTGGGACTTGAAACCTGGAGCCCCGAAACCCAAAGCCAACCAGCAAAAGCAGGACGACGGCCGGGGTCTGGTGCTTCCTGGCTACAAGTACCTCGGACCCTTCAACGGACTCGACAAGGGGGAGCCCGTCAACGCGGCGGATGCAGCGGCCCTCGAGCACGACAAGGCCTACGACCAGCAGCTCAAAGCGGGTGACAATCCGTACCTGCGGTATAACCACGCCGACGCCGAGTTTCAGGAGCGTCTGCAAGAAGATACGTCTTTTGGGGGCAACCTCGGGCGAGCAGTCTTCCAGGCCAAGAAGAGGGTTCTCGAACCTTTTGGTCTGGTTGAGGAAGGTGCTAAGACGGCTCCTGGAAAGAAACGTCCGGTAGAGCAGTCGCCACAAGAGCCAGACTCCTCCTCGGGCATTGGCAAGACAGGCCAGCAGCCCGCTAAAAAGAGACTCAATTTTGGTCAGACTGGCGACTCAGAGTCAGTCCCCGACCCACAACCTCTCGGAGAACCTCCAGCAACCCCCGCTGCTGTGGGACCTACTACAATGGCTTCAGGCGGTGGCGCACCAATGGCAGACAATAACGAAGGCGCCGACGGAGTGGGTAATGCCTCAGGAAATTGGCATTGCGATTCCACATGGCTGGGCGACAGAGTCATCACCACCAGCACCCGAACATGGGCCTTGCCCACCTATAACAACCACCTCTACAAGCAAATCTCCAGTGCTTCAACGGGGGCCAGCAACGACAACCACTACTTCGGCTACAGCACCCCCTGGGGGTATTTTGATTTCAACAGATTCCACTGCCATTTCTCACCACGTGACTGGCAGCGACTCATCAACAACAATTGGGGATTCCGGCCCAAGAGACTCAACTTCAAGCTCTTCAACATCCAAGTCAAGGAGGTCACGACGAATGATGGCGTCACGACCATCGCTAATAACCTTACCAGCACGGTTCAAGTCTTCTCGGACTCGGAGTACCAGTTGCCGTACGTCCTCGGCTCTGCGCACCAGGGCTGCCTCCCTCCGTTCCCGGCGGACGTGTTCATGATTCCGCAGTACGGCTACCTAACGCTCAACAATGGCAGCCAG------GCAGTGGGACGGTCATCCTTTTACTGCCTGGAATATTTCCCATCGCAGATGCTGAGAACGGGCAATAACTTTACCTTCAGCTACACCTTCGAGGACGTGCCTTTCCACAGCAGCTACGCGCACAGCCAGAGCCTGGACCGGCTGATGAATCCTCTCATCGACCAGTACCTGTATTACCTGAACAGAACTCAGAATCAGTCCGGAAGTGCCCAAAACAAGGACTTGCTGTTTAGCCGGGGGTCTCCAGCTGGCATGTCTGTTCAGCCCAAAAACTGGCTACCTGGACCCTGTTACCGGCAGCAGCGCGTTTCTAAAACAAAAACAGACAACAACAACAGCAACTTTACCTGGACTGGTGCTTCAAAATATAACCTTAATGGGCGTGAATCTATAATCAACCCTGGCACTGCTATGGCCTCACACAAAGACGACAAAGACAAGTTCTTTCCCATGAGCGGTGTCATGATTTTTGGAAAGGAG------AGCGCCGGAGCTTCAAACACTGCATT---GGACAATGTCATGATCACAGACGAAGAGGAAATCAAAGCCACTAACCCCGTGGCCACCGAAAGATTTGGGACTGTGGCAGTCAATCTCCAGAGCAGCAGCACAGACCCTGCGACCGGAGATGTGCATGTTATGGGAGCCTTACCTGGAATGGTGTGGCAAGACAGAGACGTATACCTGCAGGGTCCTATTTGGGCCAAAATTCCTCACACGGATGGACACTTTCACCCGTCTCCTCTCATGGGCGGCTTTGGACTTAAGCACCCGCCTCCTCAGATCCTCATCAAAAACACGCCTGTTCCTGCGAATCCTCCGGCAGAGTTTTCGGCTACAAAGTTTGCTTCATTCATCACCCAGTATTCCACAGGACAAGTGAGCGTGGAGATTGAATGGGAGCTGCAGAAAGAAAACAGCAAACGCTGGAATCCCGAAGTGCAGTATACATCTAACTATGCAAAATCTGCCAACGTTGATTTCACTGTGGACAACAATGGACTTTATACTGAGCCTCGCCCCATTGGCACCCGTTACCTCACCCGTCCCCTGTAA";
        System.out.println("Correct Lev for wt2 after removing gaps is:" + CrossoverUtils.calculateLevenshteinDistanceAfterRemovingGaps(chiString, wt2String));
        System.out.println("Incorrect Lev for wt2 because it keeps the gaps is:" + StringUtils.getLevenshteinDistance(chiString, wt2String));
        System.out.println("Incorrect Lev for wt2 because it keeps the gaps for wt2:" + StringUtils.getLevenshteinDistance(chiString.replace("-", ""), wt2String));
        System.out.println("Incorrect Lev for wt2 because it keeps the gaps for chimera9:" + StringUtils.getLevenshteinDistance(chiString, wt2String.replace("-", "")));
        System.out.println("They compared:");
        String comparedChimeraString = "ATGGCTGCCGATGGTTATCTTCCAGATTGGCTCGAGGACAACCTCTCTGAGGGCATTCGCGAGTGGTGGGACTTGAAACCTGGAGCCCCGAAACCCAAAGCCAACCAGCAAAAGCAGGACGACGGCCGGGGTCTGGTGCTTCCTGGCTACAAGTACCTCGGACCCTTCAACGGACTCGACAAGGGGGAGCCCGTCAACGCGGCGGATGCAGCGGCCCTCGAGCACGACAAGGCCTACGACCAGCAGCTCAAAGCGGGTGACAATCCGTACCTGCGGTATAACCACGCCGACGCCGAGTTTCAGGAGCGTCTGCAAGAAGATACGTCTTTTGGGGGCAACCTCGGGCGAGCAGTCTTCCAGGCGAAAAAGAGGGTTCTTGAACCTCTGGGCCTGGTTGAGGAACCTGTTAAGACGGCTCCGGGAAAAAAGAGGCCGGTAGAGCACTCTCCTGTGGAGCCAGACTCCTCCTCGGGAACCGGAAAGGCGGGCCAGCAGCCCGCTAAAAAGAGACTCAATTTTGGTCAGACTGGCGACTCAGAGTCAGTCCCCGACCCACAACCTCTCGGAGAACCTCCAGCAACCCCCGCTGCTGTGGGACCTACTACAATGGCTTCAGGCGGTGGCGCACCAATGGCAGACAATAACGAAGGCGCCGACGGAGTGGGTAATGCCTCGGGAGATTGGCATTGCGATTCCACGTGGATGGGGGACAGAGTCATCACCACCAGCACCCGAACCTGGGCCCTGCCCACCTATAACAACCACCTCTACAAGCAAATCTCCAGTGCTTCAACGGGGGCCAGCAACGACAACCACTACTTCGGCTACAGCACCCCCTGGGGGTATTTTGATTTCAACAGATTCCACTGCCATTTCTCACCACGTGACTGGCAGCGACTCATCAACAACAACTGGGGATTCCGACCCAAGAGACTCAACTTCAAGCTCTTCAACATCCAAGTCAAGGAGGTCACGACGAATGATGGCGTCACGACCATCGCTAATAACCTTACCAGCACGGTTCAGGTGTTTACTGACTCGGAGTACCAGCTCCCGTACGTCCTCGGCTCTGCGCACCAGGGCTGCCTCCCTCCGTTCCCGGCGGACGTGTTCATGATTCCGCAGTACGGCTACCTAACGCTCAACAATGGCAGCCAGGCAGTGGGACGGTCATCCTTTTACTGCCTGGAATATTTCCCATCGCAGATGCTGAGAACGGGCAATAACTTTACCTTCAGCTACACCTTCGAGGACGTGCCTTTCCACAGCAGCTACGCGCACAGCCAGAGCCTGGACCGGCTGATGAATCCTCTCATCGACCAGTACCTGTATTACCTGAACAGAACTCAGAATCAGTCCGGAAGTGCCCAAAACAAGGACTTGCTGTTTAGCCGGGGGTCTCCAGCTGGCATGTCTGTTCAGCCCAAAAACTGGCTACCTGGACCCTGTTACCGGCAGCAGCGCGTTTCTAAAACAAAAACAGACAACAACAACAGCAACTTTACCTGGACTGGTGCTTCAAAATATAACCTTAATGGGCGTGAATCTATAATCAACCCTGGCACTGCTATGGCCTCACACAAAGACGACAAAGACAAGTTCTTTCCCATGAGCGGTGTCATGATTTTTGGAAAGGAGAGCGCCGGAGCTTCAAACACTGCATTGGACAATGTCATGATCACAGACGAAGAGGAAATCAAAGCCACTAACCCCGTGGCCACCGAAAGATTTGGGACTGTGGCAGTCAATCTCCAGAGCAGCAGCACAGACCCTGCGACCGGAGATGTGCATGTTATGGGAGCCTTACCTGGAATGGTGTGGCAAGACAGAGACGTATACCTGCAGGGTCCTATTTGGGCCAAAATTCCTCACACGGATGGACACTTTCACCCGTCTCCTCTCATGGGCGGCTTTGGACTTAAGCACCCGCCTCCTCAGATCCTCATCAAAAACACGCCTGTTCCTGCGAATCCTCCGGCAGAGTTTTCGGCTACAAAGTTTGCTTCATTCATCACCCAGTATTCCACAGGACAAGTGAGCGTGGAGATTGAATGGGAGCTGCAGAAAGAAAACAGCAAACGCTGGAATCCCGAAGTGCAGTATACATCTAACTATGCAAAATCTGCCAACGTTGATTTCACTGTGGACAACAATGGACTTTATACTGAGCCTCGCCCCATTGGCACCCGTTACCTCACCCGTCCCCTG";
        String comparedWt2Stringaaaa = "ATGGCTGCCGATGGTTATCTTCCAGATTGGCTCGAGGACACTCTCTCTGAAGGAATAAGACAGTGGTGGAAGCTCAAACCTGGCCCACCACCACCAAAGCCCGCAGAGCGGCATAAGGACGACAGCAGGGGTCTTGTGCTTCCTGGGTACAAGTACCTCGGACCCTTCAACGGACTCGACAAGGGAGAGCCGGTCAACGAGGCAGACGCCGCGGCCCTCGAGCACGACAAAGCCTACGACCGGCAGCTCGACAGCGGAGACAACCCGTACCTCAAGTACAACCACGCCGACGCGGAGTTTCAGGAGCGCCTTAAAGAAGATACGTCTTTTGGGGGCAACCTCGGACGAGCAGTCTTCCAGGCGAAAAAGAGGGTTCTTGAACCTCTGGGCCTGGTTGAGGAACCTGTTAAGACGGCTCCGGGAAAAAAGAGGCCGGTAGAGCACTCTCCTGTGGAGCCAGACTCCTCCTCGGGAACCGGAAAGGCGGGCCAGCAGCCTGCAAGAAAAAGATTGAATTTTGGTCAGACTGGAGACGCAGACTCAGTACCTGACCCCCAGCCTCTCGGACAGCCACCAGCAGCCCCCTCTGGTCTGGGAACTAATACGATGGCTACAGGCAGTGGCGCACCAATGGCAGACAATAACGAGGGCGCCGACGGAGTGGGTAATTCCTCGGGAAATTGGCATTGCGATTCCACATGGATGGGCGACAGAGTCATCACCACCAGCACCCGAACCTGGGCCCTGCCCACCTACAACAACCACCTCTACAAACAAATTTCCAGCCAATCAG---GAGCCTCGAACGACAATCACTACTTTGGCTACAGCACCCCTTGGGGGTATTTTGACTTCAACAGATTCCACTGCCACTTTTCACCACGTGACTGGCAAAGACTCATCAACAACAACTGGGGATTCCGACCCAAGAGACTCAACTTCAAGCTCTTTAACATTCAAGTCAAAGAGGTCACGCAGAATGACGGTACGACGACGATTGCCAATAACCTTACCAGCACGGTTCAGGTGTTTACTGACTCGGAGTACCAGCTCCCGTACGTCCTCGGCTCGGCGCATCAAGGATGCCTCCCGCCGTTCCCAGCAGACGTCTTCATGGTGCCACAGTATGGATACCTCACCCTGAACAACGGGAGTCAG------GCAGTAGGACGCTCTTCATTTTACTGCCTGGAGTACTTTCCTTCTCAGATGCTGCGTACCGGAAACAACTTTACCTTCAGCTACACTTTTGAGGACGTTCCTTTCCACAGCAGCTACGCTCACAGCCAGAGTCTGGACCGTCTCATGAATCCTCTCATCGACCAGTACCTGTATTACTTGAGCAGAACAAACACTCCAAGTGGAACCACCACGCAGTCAAGGCTTCAGTTTTCTCAGGCCGGAGCGAGTGACATTCGGGACCAGTCTAGGAACTGGCTTCCTGGACCCTGTTACCGCCAGCAGCGAGTATCAAAGACATCTGCGGATAACAACAACAGTGAATACTCGTGGACTGGAGCTACCAAGTACCACCTCAATGGCAGAGACTCTCTGGTGAATCCGGGCCCGGCCATGGCAAGCCACAAGGACGATGAAGAAAAGTTTTTTCCTCAGAGCGGGGTTCTCATCTTTGGGAAGCAA------GGCTCAGAGAAAACAAATGTGGACAT---TGAAAAGGTCATGATTACAGACGAAGAGGAAATCAGGACAACCAATCCCGTGGCTACGGAGCAGTATGGTTCTGTATCTACCAACCTCCAGAGAGGCAACAGACAAGCAGCTACCGCAGATGTCAACACACAAGGCGTTCTTCCAGGCATGGTCTGGCAGGACAGAGATGTGTACCTTCAGGGGCCCATCTGGGCAAAGATTCCACACACGGACGGACATTTTCACCCCTCTCCCCTCATGGGTGGATTCGGACTTAAACACCCTCCTCCACAGATTCTCATCAAGAACACCCCGGTACCTGCGAATCCTTCGACCACCTTCAGTGCGGCAAAGTTTGCTTCCTTCATCACACAGTACTCCACGGGACAGGTCAGCGTGGAGATCGAGTGGGAGCTGCAGAAGGAAAACAGCAAACGCTGGAATCCCGAAATTCAGTACACTTCCAACTACAACAAGTCTGTTAATGTGGACTTTACTGTGGACACTAATGGCGTGTATTCAGAGCCTCGCCCCATTGGCACCAGATAC";
        System.out.println("They got 419");
    }

    @Test
    public void TestDeviation() {
        List<Integer> numbers = Arrays.asList(2, 4, 4, 4, 5, 7, 9);
        double dev = CrossoverUtil.standardDeviation(numbers);
        assertThat("Deviation", dev, is(2.309401076758503));
    }

    private void postToUM(List<SequenceDocument> allSequences, SequenceDocument chimera) throws IOException {
        System.out.println("Posting to http://qpmf.rx.umaryland.edu/doXOver\n\n\n");
        StringBuilder parents = new StringBuilder();
        allSequences.forEach(s -> parents.append(">" + s.getName() + "\r\n" + s.getCharSequence().toString().replace("-", "") + "\r\n"));
        System.out.println("\n");
        String chimeraString = ">" + chimera.getName() + "\r\n" + chimera.getCharSequence().toString().replace("-", "") + "\r\n";
        ///
        if (!post) {
            return;
        }
        String responseString = Request.Post("http://qpmf.rx.umaryland.edu/doXOver")
                .version(HttpVersion.HTTP_1_1)
                .bodyForm(Form.form().add("ParentsSeqs", parents.toString()).add("MutantsSeqs", chimeraString).build())
                .execute().returnContent().asString();
        Document doc = Jsoup.parse(responseString, "http://qpmf.rx.umaryland.edu/doXOver");
        Element body = doc.select("body").first();
        String cross = "Crossover:";
        String content = body.getElementsContainingText(cross).text();
        //System.out.println("Body:\n"+body);
        int crossover = getNumber(cross, content);
        int mutations = getNumber("Point mutations:", content);
        List<Integer> levDistance = Lists.newArrayList();
        for (int i = 0; i < allSequences.size(); i++) {
            SequenceDocument parentalSequence = allSequences.get(i);
            levDistance.add(Integer.parseInt(doc.select("td").get(i + 1).text()));
        }
        System.out.println("UofM crossover:" + crossover);
        System.out.println("UofM mutations:" + mutations);
        System.out.print("UofM Lev distances:");
        levDistance.forEach(lDist -> System.out.print(lDist + " "));
        //generate data to send manually
        System.out.println("\n\nData that can be sent manually to http://qpmf.rx.umaryland.edu/Xover.html\n\n");
        allSequences.stream().forEach(s -> System.out.println(">" + s.getName() + "\n" + s.getCharSequence().toString().replace("-", "")));
        System.out.println("\n");
        System.out.println(">" + chimera.getName() + "\n" + chimera.getCharSequence().toString().replace("-", "") + "\n");
    }

    private int getNumber(String what, String content) {
        Pattern p = Pattern.compile(".*" + what + "\\s(\\d*)\\s.*");
        Matcher m = p.matcher(content);
        boolean b = m.matches();
        return Integer.parseInt(m.group(1));
    }

    @Before
    public void setup() throws Exception {
        TestGeneious.initialize();
    }

    private String switchExpectationFor11 = "[Switch{fromIndex=60, fromSequence=[0], toSequence=[2]}, Switch{fromIndex=202, fromSequence=[2], toSequence=[0]}, Switch{fromIndex=310, fromSequence=[0], toSequence=[1]}, Switch{fromIndex=424, fromSequence=[1], toSequence=[0]}, Switch{fromIndex=480, fromSequence=[0], toSequence=[2]}, Switch{fromIndex=507, fromSequence=[2], toSequence=[0]}, Switch{fromIndex=540, fromSequence=[0], toSequence=[2]}, Switch{fromIndex=713, fromSequence=[2], toSequence=[1]}, Switch{fromIndex=822, fromSequence=[1], toSequence=[0, 2]}, Switch{fromIndex=882, fromSequence=[0, 2], toSequence=[1]}, Switch{fromIndex=924, fromSequence=[1], toSequence=[0, 2]}, Switch{fromIndex=942, fromSequence=[0, 2], toSequence=[1]}, Switch{fromIndex=991, fromSequence=[1], toSequence=[2]}, Switch{fromIndex=1085, fromSequence=[2], toSequence=[1]}, Switch{fromIndex=1315, fromSequence=[1], toSequence=[0, 2]}, Switch{fromIndex=1378, fromSequence=[2], toSequence=[0]}, Switch{fromIndex=1517, fromSequence=[0], toSequence=[2]}, Switch{fromIndex=1636, fromSequence=[2], toSequence=[0]}, Switch{fromIndex=1763, fromSequence=[0], toSequence=[2]}, Switch{fromIndex=1862, fromSequence=[2], toSequence=[0]}, Switch{fromIndex=1872, fromSequence=[0], toSequence=[2]}, Switch{fromIndex=1876, fromSequence=[2], toSequence=[1]}, Switch{fromIndex=1884, fromSequence=[1], toSequence=[0, 2]}, Switch{fromIndex=2138, fromSequence=[0], toSequence=[1]}, Switch{fromIndex=2282, fromSequence=[1], toSequence=[0]}]";
//    private final JUnitRuleMockery mockery = new JUnitRuleMockery() {{
//        setThreadingPolicy(new Synchroniser());
//    }};
//
//    @Test //tests only the codons on the first sequence
//    public void testConsensusGenerateOptimizedNucleotideSequencesWithIgnoredAAV8() throws Exception {
//        String oldDocFile = "Translation alignment of 8 sequences With Oligos 20 7 8 no oligos REFERENCE test.geneious";
//        String newDocFile = "Translation alignment of 8 sequences With Oligos 20 7 8 no oligos NEW.geneious";
//        List<AnnotatedPluginDocument> oldDocuments = PluginUtilities.importDocuments(new File(TestUtils.RELATIVE_TEST_DATA_DIR + oldDocFile), null);
//        List<AnnotatedPluginDocument> newDocuments = PluginUtilities.importDocuments(new File(TestUtils.RELATIVE_TEST_DATA_DIR + newDocFile), null);
//        DefaultAlignmentDocument oldDocumentOrCrash = ((DefaultAlignmentDocument) oldDocuments.get(0).getDocumentOrCrash());
//        DefaultAlignmentDocument newDocumentOrCrash = ((DefaultAlignmentDocument) newDocuments.get(0).getDocumentOrCrash());
//        for (int sec = 0; sec < oldDocumentOrCrash.getSequences().size(); sec++) {
//            if ("Optimized Consensus".equalsIgnoreCase(oldDocumentOrCrash.getSequences().get(sec).getName())) {
//                Assert.assertEquals(" Sequence index:" + sec + " named:" + oldDocumentOrCrash.getSequences().get(sec).getName() + " for old one",
//                        oldDocumentOrCrash.getSequences().get(sec).getSequenceString(), newDocumentOrCrash.getSequences().get(sec).getSequenceString());
//            }
//        }
//    }
//
//    @Test //NO OLIGOS
//    public void testPlainGeneratedOligoDocumentsWithDefaultOptionsAndNoOligos() throws Exception {
//        String oldDocFile = "Translation alignment of 8 sequences With Oligos 20 7 8 no oligos REFERENCE test.geneious";
//        String newDocFile = "Translation alignment of 8 sequences With Oligos 20 7 8 no oligos NEW.geneious";
//        TestUtils.compareDocuments(oldDocFile, newDocFile);
//    }
//
//    @Test //20 7 8 Backward First-GENERATED OLIGOS
//    public void testPlainGeneratedOligoDocumentsWithDefaultOptionsAndOligos() throws Exception {
//        String oldDocFile = "Translation alignment of 8 sequences With Oligos 20 7 8 Backwards generated oligos REFERENCE test.geneious";//old one has GAG
//        String newDocFile = "Translation alignment of 8 sequences With Oligos 20 7 8 Backwards NEW.geneious";
//        TestUtils.compareDocuments(oldDocFile, newDocFile);
//    }
//
//    @Test //20 7 8 Forward GENERATED OLIGOS
//    public void testPlainGeneratedOligoDocumentsWithForwardAndDefaultOptionsAndOligos() throws Exception {
//        String oldDocFile = "Translation alignment of 8 sequences With Oligos 20 7 8 Forward REFERENCE test.geneious";
//        String newDocFile = "Translation alignment of 8 sequences With Oligos 20 7 8 Forward NEW.geneious";
//        TestUtils.compareDocuments(oldDocFile, newDocFile);
//    }
    //    @Test
//    public void testGenerateOptimizedNucleotideSequencesX() {
//        CodonState codon = Codons.getState("ATG");//ATG is the "code"
//        //ring codon = "ATG";
//        AminoAcidState aminoAcid = GenerateOligosOperation.toAminoAcid(codon);
//        Assert.assertEquals("M", aminoAcid.getCode());
//        codon = Codons.getState("TGC");
//        aminoAcid = GenerateOligosOperation.toAminoAcid(codon);
//        Assert.assertEquals("C", aminoAcid.getCode());
//        codon = Codons.getState("UAA");
//        aminoAcid = GenerateOligosOperation.toAminoAcid(codon);
//        Assert.assertEquals("*", aminoAcid.getCode());
//    }
//    @Test
//    public void testGenerateOligosShort() {
//        generateOligosShort("ATGGCAGCYGAYGGCACAGATCAGATTGYCTCGAGGACAMYCTTT");
//    }
//
//    @Test
//    public void testGenerateOligosLonger() {
//        String bigSequence = "ATGGCTGCYGAYGGTTATCTTCCAGATTGGCTCGAGGACAMYCTYTCTGARGGMATWMGHSAGTGGTGGRMBYTSAAACCTGGMSYMCCDMMRCCMAARSCSRMMSARCRRMABMAGGACRACVGYMGGGGTCTKGTGCTTCCKGGBTAC";
//        generateOligosShort(bigSequence);
//    }
//
//    @Test
//    public void testGenerateOligos123() {
//        String bigSequence = "ATGGCTGCYGAYGGTTATCTTCCAGATTGGCTCGAGGACAMYCTYTCTGARGGMATWMGHSAGTGGTGGRMBYTSAAACCTGGMSYMCCDMMRCCMAARSCSRMMSARCRRMABMAGGACRACVGYMGGGGTCTKGTGCTTCCKGGBTACAARTACCTCGGACCCKKYAACGGACTCGACAARGGRGAGCCSGTCAACGMGGCRGACGCVGCRGCCCTCGARCACGACAARGCYTACGACCRGCAGCTCRAVRSSGGWGACAAYCCGTACCTSMRGTAYAACCACGCCGACGCSGAGTTTCAGGAGCGYCTKMAAGAAGATACGTCTTTTGGGGGCAACCTYGGVMGAGCAGTCTTCCAGGCSAARAAGMGGRTYCTYGARCCTCTBGGYCTGGTTGAGGAASSHGY";
//        generateOligosShort(bigSequence);
//    }
//
//    public void generateOligosShort(String bigSequence) {
//        GenerateOligosOperation generateOligosOperation = new GenerateOligosOperation();
//        List<SequenceDocument> list = generateOligosOperation.generateOligos(bigSequence, null, bigSequence.length()/*sequence length*/);
//        GenerateOligosOperation.scale();
//        System.out.println();
//        for (SequenceDocument sequence : list) {
//            System.out.format("Sequence:        %s\n", sequence.getSequenceString());
//        }
//        System.out.format("Sequence:        %s\n", bigSequence);
//        GenerateOligosOperation.scale();
//    }
//
//    @Test
//    public void testGenerateOptimizedNucleotideSequence() {
//        DefaultAlignmentDocument defaultAlignmentDocument = new DefaultAlignmentDocument();
//        defaultAlignmentDocument.addSequence(new DefaultNucleotideSequence("Test Sequence", "ATGCAATAA"));
//        CodonState codon = Codons.getState("ATG");//ATG is the "code"
//        //ring codon = "ATG";
//        AminoAcidState aminoAcid = GenerateOligosOperation.toAminoAcid(codon);
//        Assert.assertEquals("M", aminoAcid.getCode());
//        codon = Codons.getState("TGC");
//        aminoAcid = GenerateOligosOperation.toAminoAcid(codon);
//        Assert.assertEquals("C", aminoAcid.getCode());
//        codon = Codons.getState("UAA");
//        aminoAcid = GenerateOligosOperation.toAminoAcid(codon);
//        Assert.assertEquals("*", aminoAcid.getCode());
//    }
//
//    @Test
//    public void testGenerateOptimizedNucleotideSequenceX() throws Exception {
//        List<String> seqs = Arrays.asList(
//                "CGTCCC",
//                "CGCCCC",
//                "TCCCCC",
//                "TTTCCC",
//                "CGTCCC",
//                "CGGCCC",
//                "TCTCCC",
//                "TCACCC",
//                "AGACCC",
//                "CGACCC");
//        DefaultAlignmentDocument defaultAlignmentDocument = new DefaultAlignmentDocument();
//        AtomicInteger i=new AtomicInteger(0);
//        seqs.forEach(s -> {
//            defaultAlignmentDocument.addSequence(new DefaultNucleotideSequence("Test Sequence"+i.getAndIncrement(), s));
//        });
////        List<SequenceDocument> optimizedNucleotideSequences = GenerateOligosOperation.generateOptimizedSequences(defaultAlignmentDocument);
////        optimizedNucleotideSequences.stream().forEach(System.out::println );
//    }
}
